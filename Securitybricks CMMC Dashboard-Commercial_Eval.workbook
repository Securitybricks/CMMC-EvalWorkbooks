{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "![Image Name](https://securitybricks.io/wp-content/uploads/2024/07/SECURITY-BRICKS-black-font-logo.png) "
      },
      "customWidth": "10",
      "name": "SecuritybricksLogo",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "version": "KqlParameterItem/1.0",
            "name": "DefaultSubscription_Internal",
            "type": 1,
            "isRequired": true,
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| take 1\r\n| project subscriptionId",
            "crossComponentResources": [
              "value::selected"
            ],
            "isHiddenWhenLocked": true,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "id": "314d02bf-4691-43fa-af59-d67073c8b8fa"
          },
          {
            "id": "e6ded9a1-a83c-4762-938d-5bf8ff3d3d38",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "summarize by subscriptionId\r\n| project value = strcat(\"/subscriptions/\", subscriptionId), label = subscriptionId, selected = iff(subscriptionId =~ '{DefaultSubscription_Internal}', true, false)",
            "crossComponentResources": [
              "value::all"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "e3225ed0-6210-40a1-b2d0-66e42ffa71d6",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "resources\r\n| where type =~ 'microsoft.operationalinsights/workspaces'\r\n| order by name asc\r\n| summarize Selected = makelist(id, 10), All = makelist(id, 1000)\r\n| mvexpand All limit 100\r\n| project value = tostring(All), label = tostring(All), selected = iff(Selected contains All, true, false)",
            "crossComponentResources": [
              "{Subscription}"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              "value::all"
            ]
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Parameter Selectors"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "# [Securitybricks Cybersecurity Maturity Model Certification for Commercial Subscriptions-Eval Edition](https://securitybricks.io/cmmc-2/)\n---\n\nThis solution is an evaluation copy with limited functionality. It enables Compliance Teams, Architects, SecOps Analysts, and Consultants to gain situational awareness for cloud workload security posture. \n"
                  },
                  "name": "Workbook Overview"
                }
              ]
            },
            "name": "group - 29"
          }
        ]
      },
      "customWidth": "78.8",
      "name": "group - 27"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Control Family\\\": \\\"Executive Summary-Eval\\\", \\\"tab\\\": \\\"AS\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Access Control-Eval\\\", \\\"tab\\\": \\\"AC\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Audit & Accountability-Eval\\\", \\\"tab\\\": \\\"AU\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Awareness & Training\\\", \\\"tab\\\": \\\"AT\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Configuration Management\\\", \\\"tab\\\": \\\"CM\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Identification & Authentication\\\", \\\"tab\\\": \\\"IA\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Incident Response\\\", \\\"tab\\\": \\\"IR\\\" }\\r\\n]\",\"transformers\":null}",
        "size": 3,
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "tab",
            "parameterName": "tab2",
            "parameterType": 1
          }
        ],
        "queryType": 8,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Control Family",
              "formatter": 1,
              "numberFormat": {
                "unit": 0,
                "options": {
                  "style": "decimal"
                }
              }
            },
            {
              "columnMatch": "tab",
              "formatter": 5
            }
          ]
        },
        "sortBy": []
      },
      "customWidth": "40",
      "name": "Control Family ",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "7b682fc9-cb6b-4475-a24c-41dcb43d0cef",
            "version": "KqlParameterItem/1.0",
            "name": "isASVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "tab2",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AS",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "086e8f81-2a72-4e52-acab-40631bb21ed5",
            "version": "KqlParameterItem/1.0",
            "name": "isRCAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "tab2",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "RCA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isACVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "tab2",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AC",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "b2d05502-68c5-4d0c-8caa-d5e439a2b9ac"
          },
          {
            "id": "c01e6494-1f74-4194-88b3-c98bbabdf84f",
            "version": "KqlParameterItem/1.0",
            "name": "isAUVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "tab2",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AU",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "696bf441-12c0-45db-918c-215a1170f18e",
            "version": "KqlParameterItem/1.0",
            "name": "isATVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "tab2",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "AT",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "02596750-83d0-48ad-b9e0-2897e262ab29",
            "version": "KqlParameterItem/1.0",
            "name": "isCMVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "tab2",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "CM",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "a932ee8a-1039-4482-9fc8-ed79fe6f2ebb",
            "version": "KqlParameterItem/1.0",
            "name": "isIAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "tab2",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "IA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "2822f61e-a9f8-4419-87b6-f7b06a032cc2",
            "version": "KqlParameterItem/1.0",
            "name": "isIRVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "tab2",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "IR",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "10",
      "name": "Hidden Parameters Selectors"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Control Family\\\": \\\"Maintenance\\\", \\\"tab\\\": \\\"MA\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Media Protection\\\", \\\"tab\\\": \\\"MP\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Personnel Security\\\", \\\"tab\\\": \\\"PS\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Physical Protection\\\", \\\"tab\\\": \\\"PE\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Risk Assessment\\\", \\\"tab\\\": \\\"RM\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"Security Assessment\\\", \\\"tab\\\": \\\"CA\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"System & Communications Protection\\\", \\\"tab\\\": \\\"SC\\\" },\\r\\n\\t{ \\\"Control Family\\\": \\\"System & Information Integrity\\\", \\\"tab\\\": \\\"SI\\\" }\\r\\n]\",\"transformers\":null}",
        "size": 3,
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "tab",
            "parameterName": "Tab",
            "parameterType": 1
          }
        ],
        "queryType": 8,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "tab",
              "formatter": 5
            }
          ],
          "sortBy": [
            {
              "itemKey": "Control Family",
              "sortOrder": 1
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "Control Family",
            "sortOrder": 1
          }
        ]
      },
      "customWidth": "40",
      "name": "Control Family  - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "308bde5a-386f-4674-a712-26e31436b12e",
            "version": "KqlParameterItem/1.0",
            "name": "isMAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "MA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isMPVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "MP",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "24021387-ba53-41a3-80ff-a3c23429d82d"
          },
          {
            "id": "e18bc9ef-6479-4eda-807a-b47f58f5f2f1",
            "version": "KqlParameterItem/1.0",
            "name": "isPSVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "PS",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "401a85db-1c90-45b4-86d2-3e5439784818",
            "version": "KqlParameterItem/1.0",
            "name": "isPEVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "PE",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isRMVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "RM",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "0af0cea9-8f28-4850-b48e-93a195efa02b"
          },
          {
            "id": "e9fdb883-980a-4147-b494-43f7137f7131",
            "version": "KqlParameterItem/1.0",
            "name": "isCAVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "CA",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "c16d4f92-ce1a-4ff0-9576-23b39836e95d",
            "version": "KqlParameterItem/1.0",
            "name": "isSCVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SC",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isSIVisible",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SI",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "9637281c-861a-4ba6-90cd-6650f187f00c"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "10",
      "name": "Hidden Parameters Selectors - Copy"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "99a47f97-1aa4-4840-91ee-119aad6d6217",
                  "version": "KqlParameterItem/1.0",
                  "name": "Level",
                  "label": "CMMC 2.0 Level",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "jsonData": "[\"Level 2: Advanced\"]",
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "value": [
                    "Level 2: Advanced"
                  ]
                }
              ],
              "style": "pills",
              "doNotRunWhenHidden": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "40",
            "name": "parameters - 26"
          },
          {
            "type": 1,
            "content": {
              "json": "# [Executive Summary]\r\n---\r\n\r\nThis section leverages Azure Policy for analyzing current recommended controls for CMMC compliance. Find, fix, and resolve CMMC 2.0 recommendations aligned to the NIST SP 800-171 Regulatory Compliance Initiative. "
            },
            "name": "NS Guide"
          },
          {
            "type": 1,
            "content": {
              "json": ""
            },
            "customWidth": "10",
            "name": "text - 11"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "securityresources\r\n| where type == \"microsoft.security/regulatorycompliancestandards\"\r\n| extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"NIST SP 800 171 R2\"\r\n| extend \r\n\tpassedControls = trim (' ', tostring(properties.passedControls)), \r\n\tfailedControls = trim(' ',tostring(properties.failedControls)), \r\n\tstate \t\t   = trim(' ', tostring(properties.state)), \r\n\tunsupportedControls = trim(' ', tostring(properties.unsupportedControls)), \r\n\tskippedControls     = trim(' ', tostring(properties.skippedControls))\r\n| project name, passedControls, failedControls, unsupportedControls, skippedControls , subscriptionId\r\n| order by passedControls desc",
              "size": 4,
              "title": "Compliance Control Overview",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Total\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "PassedControls",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "name",
                    "label": "Compliance Name"
                  },
                  {
                    "columnId": "passedControls",
                    "label": "# of Passed Controls"
                  },
                  {
                    "columnId": "failedControls",
                    "label": "# of Failed Controls"
                  },
                  {
                    "columnId": "unsupportedControls",
                    "label": "# of Unsupported Controls"
                  },
                  {
                    "columnId": "skippedControls",
                    "label": "# of Skipped Controls"
                  },
                  {
                    "columnId": "subscriptionId",
                    "label": "Subscription ID"
                  }
                ]
              }
            },
            "name": "query - 3 - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "parameters": [
                {
                  "id": "dd8f4188-2076-4696-ba56-8418a3fcc6f5",
                  "version": "KqlParameterItem/1.0",
                  "name": "SelectCompliance",
                  "type": 5,
                  "query": "securityresources\r\n| where type == \"microsoft.security/regulatorycompliancestandards\"\r\n| where name == \"NIST-SP-800-171-R2\"\r\n| project name\r\n",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": []
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "value": null,
                  "label": "Compliance Setting"
                },
                {
                  "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                  "version": "KqlParameterItem/1.0",
                  "name": "selectState",
                  "type": 5,
                  "query": "securityresources\r\n| where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n | extend  state \t\t   = trim(' ', tostring(properties.state))\r\n| summarize by state",
                  "crossComponentResources": [
                    "{Subscription}"
                  ],
                  "value": "Failed",
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources",
                  "label": "Select Status"
                }
              ],
              "style": "above",
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            "name": "parameters - 13"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "securityresources\r\n| where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n| parse id with *\"/regulatoryComplianceStandards/\" strControlName \"/regulatory\"*\r\n | extend \r\n\t state \t\t   = trim(' ', tostring(properties.state))\r\n\t,description    = trim(' ', tostring(properties.description))\r\n| where  strControlName startswith '{SelectCompliance}'\r\n| extend isState = iif(isempty('{selectState}'),\"All states\",'{selectState}')\r\n| where isState == state\r\n| summarize by  ControlName = strControlName, name, Status = isState, description\r\n",
              "size": 0,
              "title": "Compliance Control Overview",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Status",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Skipped",
                          "representation": "orange"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Passed",
                          "representation": "green"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Failed",
                          "representation": "redBright"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "failed",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "lightBlue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Total\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "PassedControls",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                ]
              }
            },
            "name": "query - 3 - selectstate",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"NIST SP 800 171 R2\"\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend TimeGenerated = tostring(properties1.status.statusChangeDate)\r\n    | extend RecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"NIST SP 800 171 R2\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n    | extend RecommendationName = tostring(properties.description)\r\n| join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"NIST SP 800 171 R2\" \r\n    | extend RecommendationName = tostring(properties.description)\r\n    | extend RecommendationLink = tostring(properties.assessmentDetailsLink)\r\n    | project RecommendationName, RecommendationLink) on RecommendationName\r\n  | summarize arg_max(TimeGenerated, *) by RecommendationName, tostring(RecommendationLink), tostring(state), tostring(complianceState)\r\n    | summarize Failed = countif(state == \"Unhealthy\"), Passed = countif(state == \"Healthy\" or complianceState == \"Passed\"), Total = countif(state == \"Unhealthy\" or state == \"Healthy\" or complianceState == \"Passed\")\r\n    | extend PassedControls = (Passed/todouble(Total))*100\r\n    | project Total, PassedControls, Passed, Failed\r\n    | sort by Total, Passed desc\r\n ",
              "size": 4,
              "title": "Applicable Policy Compliance Summary",
              "noDataMessage": "Confirm the Microsoft Defender for Cloud: Regulatory Compliance Initiative for NIST SP 800-171 R2 is Enabled. See https://docs.microsoft.com/azure/defender-for-cloud/update-regulatory-compliance-packages",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Total\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "PassedControls",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true,
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "Total",
                    "label": "Total Policies"
                  },
                  {
                    "columnId": "PassedControls",
                    "label": "Passing Policies %"
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "query - 3 - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"NIST SP 800 171 R2\"\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend RecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"NIST SP 800 171 R2\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n    | extend RecommendationName = tostring(properties.description)\r\n    | summarize Failed = countif(state == \"Unhealthy\"), Passed = countif(state == \"Healthy\" or complianceState == \"Passed\"), Total = countif(state == \"Unhealthy\" or state == \"Healthy\" or complianceState == \"Passed\") by RecommendationName, ControlID = controlId\r\n    | extend PassedControls = (Passed/todouble(Total))*100\r\n| join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"NIST SP 800 171 R2\"\r\n    | extend RecommendationName = tostring(properties.description)\r\n    | extend RecommendationLink = tostring(properties.assessmentDetailsLink)\r\n    | project RecommendationName, RecommendationLink, name) on RecommendationName\r\n    | extend Level=iff(ControlID in (\"3.1.1\",\"3.1.2\",\"3.1.20\",\"3.1.22\",\"3.4.1\",\"3.5.2\",\"3.5.2\",\"3.8.3\",\"3.13.1\",\"3.13.5\",\"3.14.1\",\"3.14.2\",\"3.14.4\",\"3.14.5\"), \"Level 1: Foundational\",\"Level 2: Advanced\")\r\n    | where Level in ({Level})\r\n    | distinct RecommendationName, Total, RecommendationLink, PassedControls, Passed, Failed,  name\r\n    | sort by Total, Passed desc\r\n    | limit 250",
              "size": 0,
              "title": "Recommendations ",
              "noDataMessage": "Confirm the Microsoft Defender for Cloud: Regulatory Compliance Initiative for NIST SP 800-171 R2 is Enabled. See https://docs.microsoft.com/azure/defender-for-cloud/update-regulatory-compliance-packages",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "RecommendationName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "representation": "Gear",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Total\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "RecommendationLink",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "OpenBlade",
                      "linkLabel": "Remediate >>",
                      "linkIsContextBlade": false,
                      "bladeOpenContext": {
                        "bladeName": "RecommendationsBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "assessmentKey",
                            "source": "column",
                            "value": "name"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "PassedControls",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "Passed",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "Failed",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "name",
                    "formatter": 5
                  }
                ]
              }
            },
            "name": "query - 3",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"NIST SP 800 171 R2\"\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend TimeGenerated = tostring(properties1.status.statusChangeDate)\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend RecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"NIST SP 800 171 R2\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n    | extend RecommendationName = tostring(properties.description)\r\n    | extend Level=iff(controlId in (\"3.1.1\",\"3.1.2\",\"3.1.20\",\"3.1.22\",\"3.4.1\",\"3.5.2\",\"3.5.2\",\"3.8.3\",\"3.13.1\",\"3.13.5\",\"3.14.1\",\"3.14.2\",\"3.14.4\",\"3.14.5\"), \"Level 1: Foundational\",\"Level 2: Advanced\")\r\n    | where Level in ({Level})\r\n| summarize arg_max(TimeGenerated, *) by RecommendationName, Level, tostring(RecommendationLink), tostring(state), tostring(complianceState)\r\n| distinct RecommendationName, resourceId, tostring(state), tostring(complianceState)\r\n| summarize Failed = countif(state == \"Unhealthy\"), Passed = countif(state == \"Healthy\"), Total = countif(state == \"Unhealthy\" or state == \"Healthy\") by resourceId\r\n| extend PassedControls = (Passed/todouble(Total))*100\r\n| where Failed > 0\r\n| project AssessedResourceId=resourceId, Total, PassedControls, Passed, Failed\r\n| sort by Total, Passed desc\r\n| limit 250\r\n",
              "size": 0,
              "title": "Recommendations by Asset",
              "noDataMessage": "No Recommendations Observed Within These Thresholds. Confirm the Microsoft Defender for Cloud: Regulatory Compliance Initiative for NIST SP 800-53 R4 is Enabled",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AssessedResourceId",
                    "formatter": 13,
                    "formatOptions": {
                      "linkTarget": "Resource",
                      "showIcon": true
                    }
                  },
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "[\"Passed\"]/[\"Total\"]",
                        "columnSettings": [
                          {
                            "columnName": "Passed",
                            "color": "green"
                          },
                          {
                            "columnName": "Failed",
                            "color": "redBright"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "PassedControls",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true,
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "Passed",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "Failed",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "resourceId",
                    "formatter": 13,
                    "formatOptions": {
                      "showIcon": true
                    }
                  },
                  {
                    "columnMatch": "RecommendationName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "representation": "Gear",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "RecommendationLink",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Remediate >>"
                    }
                  }
                ]
              }
            },
            "name": "query - 9",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId ==  \"NIST SP 800 171 R2\"\r\n    | join kind = leftouter(\r\n    securityresources\r\n    | where type == \"microsoft.security/assessments\") on subscriptionId, name\r\n    | extend complianceState = properties.state\r\n    | extend resourceSource = tolower(tostring(properties1.resourceDetails.Source))\r\n    | extend recommendationId = id1\r\n    | extend resourceId = trim(' ', tolower(tostring(case(resourceSource =~ 'azure', properties1.resourceDetails.Id,\r\n                                                        resourceSource =~ 'gcp', properties1.resourceDetails.GcpResourceId,\r\n                                                        resourceSource =~ 'aws', properties1.resourceDetails.AwsResourceId,\r\n                                                        extract('^(.+)/providers/Microsoft.Security/assessments/.+$',1,recommendationId)))))\r\n    | extend regexResourceId = extract_all(@\"/providers/[^/]+(?:/([^/]+)/[^/]+(?:/[^/]+/[^/]+)?)?/([^/]+)/([^/]+)$\", resourceId)[0]\r\n    | extend resourceType = iff(regexResourceId[1] != \"\", regexResourceId[1], iff(regexResourceId[0] != \"\", regexResourceId[0], \"subscriptions\"))\r\n    | extend resourceName = regexResourceId[2]\r\n    | extend recommendationName = name\r\n    | extend RecommendationName = properties1.displayName\r\n    | extend description = properties1.metadata.description\r\n    | extend remediationSteps = properties1.metadata.remediationDescription\r\n    | extend severity = properties1.metadata.severity\r\n    | extend state = properties1.status.code\r\n    | extend TimeGenerated = tostring(properties1.status.statusChangeDate)\r\n    | extend notApplicableReason = properties1.status.cause\r\n    | extend RecommendationLink = properties1.links.azurePortal\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | extend complianceControlId = extract(@\"/regulatoryComplianceControls/([^/]*)\", 1, id)\r\n    | join kind = leftouter (securityresources\r\n    | where type == \"microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols\"\r\n    | extend complianceStandardId = replace( \"-\", \" \", extract(@'/regulatoryComplianceStandards/([^/]*)', 1, id))\r\n    | where complianceStandardId == \"NIST SP 800 171 R2\"\r\n    | extend  controlName = tostring(properties.description)\r\n    | project controlId = name, controlName\r\n    | distinct  *) on $right.controlId == $left.complianceControlId\r\n    | extend RecommendationName = tostring(properties.description)\r\n    | extend Level=iff(controlId in (\"3.1.1\",\"3.1.2\",\"3.1.20\",\"3.1.22\",\"3.4.1\",\"3.5.2\",\"3.5.2\",\"3.8.3\",\"3.13.1\",\"3.13.5\",\"3.14.1\",\"3.14.2\",\"3.14.4\",\"3.14.5\"), \"Level 1: Foundational\",\"Level 2: Advanced\")\r\n    | where Level in ({Level})\r\n| summarize arg_max(TimeGenerated, *) by RecommendationName, Level, tostring(RecommendationLink), tostring(state), controlId, tostring(severity)\r\n| where resourceId <> \"\"\r\n| project ResourceID=resourceId, RecommendationName, Severity=tostring(severity), CurrentState=tostring(state), RecommendationLink=tostring(RecommendationLink), name, FirstObserved=TimeGenerated\r\n| distinct ResourceID, RecommendationName, Severity, CurrentState, RecommendationLink, FirstObserved, name\r\n| where CurrentState == \"Unhealthy\"\r\n| extend Rank=iff(Severity == \"High\", 3, iff(Severity == \"Medium\", 2, iff(Severity == \"Low\", 1, 0)))\r\n| sort by Rank desc\r\n| limit 2500",
              "size": 0,
              "title": "Current Recommendation Details",
              "noDataMessage": "Confirm the Microsoft Defender for Cloud: Regulatory Compliance Initiative for NIST SP 800-171 R2 is Enabled. See https://docs.microsoft.com/azure/defender-for-cloud/update-regulatory-compliance-packages",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "ResourceID",
                    "formatter": 13,
                    "formatOptions": {
                      "linkTarget": "Resource",
                      "showIcon": true
                    }
                  },
                  {
                    "columnMatch": "RecommendationName",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "representation": "Gear",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Level",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "representation": "Persistence",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "ControlID",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev0",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "State",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "Recommendation",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "OpenBlade",
                      "linkLabel": "Remediate >>",
                      "linkIsContextBlade": false,
                      "bladeOpenContext": {
                        "bladeName": "RecommendationsBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "assessmentKey",
                            "source": "column",
                            "value": "name"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "name",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "FirstObserved",
                    "formatter": 6
                  },
                  {
                    "columnMatch": "Rank",
                    "formatter": 5
                  }
                ],
                "rowLimit": 2500
              }
            },
            "name": "query - 8",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isASVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Assessment",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# [Regulatory Compliance Alignment](https://docs.microsoft.com/azure/governance/policy/samples/nist-sp-800-171-r2)\r\n---\r\nControls crosswalk provides a mapping of CMMC 2.0 controls across additional compliance frameworks. This provides free-text search capabilities mapping numerous frameworks including NIST SP 800-171 R2 and NIST SP 800-53 R4. There is also a mapping for primary and secondary services which aligns with the Microsoft Technical Reference Guide for CMMC 2.0."
            },
            "customWidth": "40",
            "name": "Controls Mapping"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let Crosswalk = datatable([\"Control Name\"]: string, [\"Control Number\"]: string, [\"Control Family\"]: string, [\"NIST SP 800-171 R2\"]: string, [\"NIST SP 800-53 R4\"]: string, [\"Primary Services\"]: string, [\"Secondary Services\"]: string) [\r\n\"Authorized Access Control\",\t\"AC.L1-3.1.1\",\t\"Access Control\",\t\"3.1.1\",\t\"AC-2 | AC-3 | AC-17\",\t\"Microsoft Defender for Cloud | Azure Active Directory | Microsoft Endpoint Manager\",\t\"Conditional Access | Customer Lockbox | Azure AD Privileged Identity Management | Microsoft Defender for Office 365\",\r\n\"Transaction & Function Control\",\t\"AC.L1-3.1.2\",\t\"Access Control\",\t\"3.1.2\",\t\"AC-2 | AC-3 | AC-17\",\t\"Microsoft Defender for Cloud | Azure Active Directory | Azure AD Privileged Identity Management\",\t\"Network Security Groups | Conditional Access | GitHub Enterprise Cloud | GitHub AE\",\r\n\"External Connections\",\t\"AC.L1-3.1.20\",\t\"Access Control\",\t\"3.1.20\",\t\"AC-20 | AC-20(1)\",\t\"Microsoft Defender for Cloud | Azure Active Directory\",\t\"Microsoft Azure Portal | Azure Firewall | Network Security Groups | Conditional Access | Microsoft Endpoint Manager\",\r\n\"Control Public Information\",\t\"AC.L1-3.1.22\",\t\"Access Control\",\t\"3.1.22\",\t\"AC-22\",\t\"Microsoft Endpoint Manager\",\t\"Microsoft Sentinel\",\r\n\"Control CUI Flow\",\t\"AC.L2-3.1.3\",\t\"Access Control\",\t\"3.1.3\",\t\"AC-4\",\t\"Azure Web Application Firewall | Azure Information Protection | Microsoft 365 Compliance Manager | Microsoft Defender for Cloud\",\t\"Network Security Groups | Microsoft Endpoint Manager | Microsoft Defender for Cloud Apps | Microsoft Defender for Identity\",\r\n\"Separation of Duties\",\t\"AC.L2-3.1.4\",\t\"Access Control\",\t\"3.1.4\",\t\"AC-5\",\t\"Azure Active Directory | Microsoft Defender for Cloud\",\t\"Azure AD Privileged Identity Management\",\r\n\"Least Privilege\",\t\"AC.L2-3.1.5\",\t\"Access Control\",\t\"3.1.5\",\t\"AC-6 | AC-6(1) | AC-6(5)\",\t\"Azure AD Privileged Identity Management | Microsoft Defender for Cloud\",\t\"Azure Active Directory | GitHub Enterprise Cloud | GitHub AE\",\r\n\"Non-Privileged Account Use\",\t\"AC.L2-3.1.6\",\t\"Access Control\",\t\"3.1.6\",\t\"AC-6(2)\",\t\"Azure Active Directory | Microsoft Defender for Cloud\",\t\"Azure AD Privileged Identity Management\",\r\n\"Privileged Functions\",\t\"AC.L2-3.1.7\",\t\"Access Control\",\t\"3.1.7\",\t\"AC-6(9) | AC-6(10)\",\t\"Azure Active Directory | Azure AD Privileged Identity Management | Microsoft Defender for Cloud\",\t\"Microsoft Endpoint Manager | Microsoft Defender for Office 365 | Microsoft 365 Compliance Manager\",\r\n\"Unsuccessful Logon Attempts\",\t\"AC.L2-3.1.8\",\t\"Access Control\",\t\"3.1.8\",\t\"AC-7\",\t\"Azure Active Directory | Microsoft Defender for Identity | Microsoft Sentinel\",\t\"Password Protection for Azure AD\",\r\n\"Privacy & Security Notices\",\t\"AC.L2-3.1.9\",\t\"Access Control\",\t\"3.1.9\",\t\"AC-8\",\t\"Microsoft Azure Portal | Virtual Machines\",\t\"Azure Active Directory\",\r\n\"Session Lock\",\t\"AC.L2-3.1.10\",\t\"Access Control\",\t\"3.1.10\",\t\"AC-11 | AC-11(1)\",\t\"Microsoft Azure Portal | Virtual Machines | Microsoft Endpoint Manager\",\t\"NA\",\r\n\"Session Termination\",\t\"AC.L2-3.1.11\",\t\"Access Control\",\t\"3.1.11\",\t\"AC-12\",\t\"Microsoft Azure Portal | Azure AD Privileged Identity Management\",\t\"Application Gateway | Azure Bastion\",\r\n\"Control Remote Access\",\t\"AC.L2-3.1.12\",\t\"Access Control\",\t\"3.1.12\",\t\"AC-17(1)\",\t\"Azure Active Directory | Microsoft Defender for Cloud | Microsoft Sentinel | Azure Bastion\",\t\"Microsoft Azure Portal | Azure ExpressRoute | Network Security Groups | Conditional Access | Intune/Microsoft Endpoint Manager | Microsoft Defender for Office 365\",\r\n\"Remote Access Confidentiality\",\t\"AC.L2-3.1.13\",\t\"Access Control\",\t\"3.1.13\",\t\"AC-17(2)\",\t\"Microsoft Azure Portal | Azure Active Directory\",\t\"Load Balancer | Azure Multi-Factor Authentication\",\r\n\"Remote Access Routing\",\t\"AC.L2-3.1.14\",\t\"Access Control\",\t\"3.1.14\",\t\"AC-17(3)\",\t\"Azure Bastion | VPN Gateway | Intune/Microsoft Endpoint Manager\",\t\"Azure ExpressRoute | Azure Front Door | Named Locations | Network Security Groups | Azure Web Application Firewall | Conditional Access\",\r\n\"Privileged Remote Access\",\t\"AC.L2-3.1.15\",\t\"Access Control\",\t\"3.1.15\",\t\"AC-17(4)\",\t\"Azure Active Directory | Azure AD Privileged Identity Management\",\t\"Named Locations | Azure Virtual Machines | Conditional Access | Intune/Microsoft Endpoint Manager\",\r\n\"Wireless Access Authorization\",\t\"AC.L2-3.1.16\",\t\"Access Control\",\t\"3.1.16\",\t\"AC-18\",\t\"Intune/Microsoft Endpoint Manager\",\t\"NA\",\r\n\"Wireless Access Protection\",\t\"AC.L2-3.1.17\",\t\"Access Control\",\t\"3.1.17\",\t\"AC-18(1)\",\t\"Intune/Microsoft Endpoint Manager\",\t\"NA\",\r\n\"Mobile Device Connection\",\t\"AC.L2-3.1.18\",\t\"Access Control\",\t\"3.1.18\",\t\"AC-19\",\t\"Intune/Microsoft Endpoint Manager\",\t\"NA\",\r\n\"Encrypt CUI on Mobile\",\t\"AC.L2-3.1.19\",\t\"Access Control\",\t\"3.1.19\",\t\"AC-19(5)\",\t\"Conditional Access | Intune/Microsoft Endpoint Manager\",\t\"NA\",\r\n\"Portable Storage Use\",\t\"AC.L2-3.1.21\",\t\"Access Control\",\t\"3.1.21\",\t\"AC-20(2)\",\t\"Intune/Microsoft Endpoint Manager\",\t\"Named Locations\",\r\n\"Role-Based Risk Awareness\",\t\"AT.L2-3.2.1\",\t\"Awareness & Training\",\t\"3.2.1\",\t\"AT-2 | AT-3\",\t\"NA\",\t\"Microsoft Learn\",\r\n\"Role-Based Training\",\t\"AT.L2-3.2.2\",\t\"Awareness & Training\",\t\"3.2.2\",\t\"AT-2 | AT-4\",\t\"NA\",\t\"Microsoft Learn\",\r\n\"Insider Threat Awareness\",\t\"AT.L2-3.2.3\",\t\"Awareness & Training\",\t\"3.2.3\",\t\"AT-2(2)\",\t\"NA\",\t\"Microsoft Learn\",\r\n\"User Accountability\",\t\"AU.L2-3.3.2\",\t\"Audit & Accountability\",\t\"3.3.2\",\t\"AU-2 | AU-3 | AU-3(1) | AU-6 | AU-11 | AU-12\",\t\"Microsoft Sentinel\",\t\"Intune/Microsoft Endpoint Manager | O365 Security and Compliance\",\r\n\"Event Review\",\t\"AU.L2-3.3.3\",\t\"Audit & Accountability\",\t\"3.3.3\",\t\"AU-2(3)\",\t\"NA\",\t\"Microsoft Sentinel | Azure Active Directory | Intune/Microsoft Endpoint Manager | Microsoft Defender for Cloud Apps | O365 Security and Compliance\",\r\n\"Audit Failure Alerting\",\t\"AU.L2-3.3.4\",\t\"Audit & Accountability\",\t\"3.3.4\",\t\"AU-5\",\t\"Microsoft Sentinel\",\t\"Azure Active Directory | Intune/Microsoft Endpoint Manager\",\r\n\"Audit Correlation\",\t\"AU.L2-3.3.5\",\t\"Audit & Accountability\",\t\"3.3.5\",\t\"AU-6(3)\",\t\"Microsoft Sentinel | Microsoft Defender for Cloud Apps | Microsoft 365 Defender\",\t\"Log Analytics Workspace | Microsoft Defender for Cloud Apps | Microsoft Defender for Identity | O365 Security and Compliance | Microsoft Defender for Cloud\",\r\n\"Reduction & Reporting\",\t\"AU.L2-3.3.6\",\t\"Audit & Accountability\",\t\"3.3.6\",\t\"AU-7\",\t\"Microsoft Defender for Cloud | Microsoft Sentinel\",\t\"Log Analytics Workspace | Azure Active Directory | O365 Security and Compliance\",\r\n\"Authoritative Time Source\",\t\"AU.L2-3.3.7\",\t\"Audit & Accountability\",\t\"3.3.7\",\t\"AU-8 | AU-8(1)\",\t\"Azure Active Directory\",\t\"NA\",\r\n\"Audit Protection\",\t\"AU.L2-3.3.8\",\t\"Audit & Accountability\",\t\"3.3.8\",\t\"AU-6(7) | AU-9\",\t\"Log Analytics Workspace | Azure Active Directory | O365 Security and Compliance\",\t\"Conditional Access\",\r\n\"Audit Management\",\t\"AU.L2-3.3.9\",\t\"Audit & Accountability\",\t\"3.3.9\",\t\"AU-6(7) | AU-9\",\t\"Log Analytics Workspace | Azure Active Directory\",\t\"Conditional Access |  O365 Security and Compliance\",\r\n\"System Baselining\",\t\"CM.L2-3.4.1\",\t\"Configuration Management\",\t\"3.4.1\",\t\"CM-2 | CM-6 | CM-8 | CM-8(1)\",\t\"Microsoft Defender for Cloud | Intune/Microsoft Endpoint Manager | Microsoft Defender for Endpoint | GitHub Enterprise Cloud | GitHub AE\",\t\"Azure Virtual Machines\",\r\n\"Security Configuration Enforcement\",\t\"CM.L2-3.4.2\",\t\"Configuration Management\",\t\"3.4.2\",\t\"CM-2 | CM-6 | CM-8 | CM-8(1)\",\t\"Azure Active Directory | Intune/Microsoft Endpoint Manager\",\t\"NA\",\r\n\"System Change Management\",\t\"CM.L2-3.4.3\",\t\"Configuration Management\",\t\"3.4.3\",\t\"CM-3\",\t\"Microsoft Defender for Cloud | GitHub Enterprise Cloud | GitHub AE\",\t\"Log Analytics Workspace | Azure Active Directory | Intune/Microsoft Endpoint Manager\",\r\n\"Security Impact Analysis\",\t\"CM.L2-3.4.4\",\t\"Configuration Management\",\t\"3.4.4\",\t\"CM-4\",\t\"GitHub Enterprise Cloud | GitHub AE\",\t\"Intune/Microsoft Endpoint Manager | Microsoft Defender Endpoint\",\r\n\"Access Restrictions for Change\",\t\"CM.L2-3.4.5\",\t\"Configuration Management\",\t\"3.4.5\",\t\"CM-5\",\t\"Azure Active Directory\",\t\"Azure Firewall | Network Security Groups | Azure Web Application Firewall | Virtual Network | Conditional Access | Intune/Microsoft Endpoint Manager | GitHub Enterprise Cloud | GitHub AE\",\r\n\"Least Functionality\",\t\"CM.L2-3.4.6\",\t\"Configuration Management\",\t\"3.4.6\",\t\"CM-7\",\t\"Azure Active Directory | Intune/ Microsoft Endpoint Manager\",\t\"Microsoft 365 Defender\",\r\n\"Nonessential Functionality\",\t\"CM.L2-3.4.7\",\t\"Configuration Management\",\t\"3.4.7\",\t\"CM-7(1) | CM-7(2)\",\t\"Network Security Groups\",\t\"Microsoft Defender for Cloud | Azure Firewall | Azure Web Application Firewall | Intune/Microsoft Endpoint Manager\",\r\n\"Application Execution Policy\",\t\"CM.L2-3.4.8\",\t\"Configuration Management\",\t\"3.4.8\",\t\"CM-7(4) | CM-7(5)\",\t\"Azure Virtual Machines | Intune/Microsoft Endpoint Manager | Microsoft Defender for Cloud Apps\",\t\"Azure Firewall | Network Security Groups | Azure Web Application Firewall | Conditional Access | Microsoft Defender for Endpoint | GitHub Enterprise Cloud | GitHub AE\",\r\n\"User-Installed Software\",\t\"CM.L2-3.4.9\",\t\"Configuration Management\",\t\"3.4.9\",\t\"CM-11\",\t\"Microsoft Sentinel | Intune/Microsoft Endpoint Manager\",\t\"Azure Active Directory | Microsoft Defender for Cloud Apps | Microsoft Defender for Endpoint | Microsoft Defender for Identity | GitHub Enterprise Cloud\",\r\n\"Authentication\",\t\"IA.L1-3.5.2\",\t\"Identification & Authentication\",\t\"3.5.2\",\t\"IA-2 | IA-3 | IA-5\",\t\"Azure Active Directory | Azure Multi-Factor Authentication | Conditional Access | Intune/Microsoft Endpoint Manager\",\t\"Customer Lockbox\",\r\n\"Replay-Resistant Authentication\",\t\"IA.L2-3.5.4\",\t\"Identification & Authentication\",\t\"3.5.4\",\t\"IA-2(8) | IA-2(9)\",\t\"Microsoft Azure Portal | Azure Active Directory | Azure Multi-Factor Authentication | Intune/Microsoft Endpoint Manager\",\t\"NA\",\r\n\"Identifier Reuse\",\t\"IA.L2-3.5.5\",\t\"Identification & Authentication\",\t\"3.5.5\",\t\"IA-4\",\t\"Azure Active Directory\",\t\"Intune/Microsoft Endpoint Manager | O365 Security and Compliance\",\r\n\"Identifier Handling\",\t\"IA.L2-3.5.6\",\t\"Identification & Authentication\",\t\"3.5.6\",\t\"IA-4\",\t\"Azure Active Directory | Microsoft Defender for Identity\",\t\"NA\",\r\n\"Password Complexity\",\t\"IA.L2-3.5.7\",\t\"Identification & Authentication\",\t\"3.5.7\",\t\"IA-5(1)\",\t\"Azure Active Directory\",\t\"Intune/Microsoft Endpoint Manager | Password Protection for Azure AD\",\r\n\"Password Reuse\",\t\"IA.L2-3.5.8\",\t\"Identification & Authentication\",\t\"3.5.8\",\t\"IA-5(1)\",\t\"Azure Active Directory\",\t\"Intune/Microsoft Endpoint Manager | Password Protection for Azure AD\",\r\n\"Temporary Passwords\",\t\"IA.L2-3.5.9\",\t\"Identification & Authentication\",\t\"3.5.9\",\t\"IA-5(1)\",\t\"Azure Active Directory\",\t\"NA\",\r\n\"Cryptographically-Protected Passwords\",\t\"IA.L2-3.5.10\",\t\"Identification & Authentication\",\t\"3.5.10\",\t\"IA-5(1)\",\t\"Microsoft Azure Portal | Azure Key Vault | Azure Virtual Machines | Azure Active Directory | Intune/Microsoft Endpoint Manager\",\t\"NA\",\r\n\"Obscure Feedback\",\t\"IA.L2-3.5.11\",\t\"Identification & Authentication\",\t\"3.5.11\",\t\"IA-6\",\t\"Microsoft Azure Portal | Intune/Microsoft Endpoint Manager\",\t\"Azure Bastion | Azure Virtual Machines\",\r\n\"Incident Handling\",\t\"IR.L2-3.6.1\",\t\"Incident Response\",\t\"3.6.1\",\t\"IR-2 | IR-4 | IR-5 | IR-6 | IR-7\",\t\"Microsoft Sentinel\",\t\"Microsoft Defender for Endpoint | Microsoft Defender for Office 365\",\r\n\"Incident Reporting\",\t\"IR.L2-3.6.2\",\t\"Incident Response\",\t\"3.6.2\",\t\"IR-2 | IR-4 | IR-5 | IR-6 | IR-7\",\t\"Microsoft Sentinel\",\t\"NA\",\r\n\"Incident Response Testing\",\t\"IR.L2-3.6.3\",\t\"Incident Response\",\t\"3.6.3\",\t\"IR-3\",\t\"NA\",\t\"Microsoft Sentinel\",\r\n\"Perform Maintenance\",\t\"MA.L2-3.7.1\",\t\"Maintenance\",\t\"3.7.1\",\t\"MA-2 | MA-3 | MA-3(1) | MA-3(2)\",\t\"NA\",\t\"Microsoft Azure Portal | Azure Virtual Machines | Intune/Microsoft Endpoint Manager | Microsoft Defender for Endpoint\",\r\n\"System Maintenance Control\",\t\"MA.L2-3.7.2\",\t\"Maintenance\",\t\"3.7.2\",\t\"MA-2 | MA-3 | MA-3(1) | MA-3(2)\",\t\"Network Security Groups | Azure Active Directory\",\t\"Azure Bastion | Intune/Microsoft Endpoint Manager\",\r\n\"Equipment Sanitization\",\t\"MA.L2-3.7.3\",\t\"Maintenance\",\t\"3.7.3\",\t\"MA-2\",\t\"NA\",\t\"NA\",\r\n\"Media Inspection\",\t\"MA.L2-3.7.4\",\t\"Maintenance\",\t\"3.7.4\",\t\"MA-3(2)\",\t\"NA\",\t\"NA\",\r\n\"Nonlocal Maintenance\",\t\"MA.L2-3.7.5\",\t\"Maintenance\",\t\"3.7.5\",\t\"MA-4\",\t\"Microsoft Azure Portal | Azure Active Directory | Azure Multi-Factor Authentication\",\t\"Intune/Microsoft Endpoint Manager\",\r\n\"Maintenance Personnel\",\t\"MA.L2-3.7.6\",\t\"Maintenance\",\t\"3.7.6\",\t\"MA-5\",\t\"NA\",\t\"Customer Lockbox\",\r\n\"Media Disposal\",\t\"MP.L1-3.8.3\",\t\"Media Protection\",\t\"3.8.3\",\t\"MP-2 | MP-4 | MP-6\",\t\"Azure Key Vault\",\t\"Azure Information Protection\",\r\n\"Media Protection\",\t\"MP.L2-3.8.1\",\t\"Media Protection\",\t\"3.8.1\",\t\"MP-2 | MP-4 | MP-6\",\t\"Azure Key Vault | Azure Information Protection | Intune/Microsoft Endpoint Manager\",\t\"Azure Virtual Machines\",\r\n\"Media Access\",\t\"MP.L2-3.8.2\",\t\"Media Protection\",\t\"3.8.2\",\t\"MP-2 | MP-4 | MP-6\",\t\"Azure Active Directory | Azure Information Protection | Conditional Access | Intune/Microsoft Endpoint Manager\",\t\"Network Security Groups\",\r\n\"Media Markings\",\t\"MP.L2-3.8.4\",\t\"Media Protection\",\t\"3.8.4\",\t\"MP-2 | MP-4 | MP-6\",\t\"Azure Key Vault\",\t\"Azure Information Protection\",\r\n\"Media Accountability\",\t\"MP.L2-3.8.5\",\t\"Media Protection\",\t\"3.8.5\",\t\"MP-5\",\t\"Azure Key Vault\",\t\"Azure Information Protection | Intune/Microsoft Endpoint Manager\",\r\n\"Portable Storage Encryption\",\t\"MP.L2-3.8.6\",\t\"Media Protection\",\t\"3.8.6\",\t\"MP-5(4)\",\t\"Azure Key Vault | Intune/Microsoft Endpoint Manager\",\t\"Azure Information Protection\",\r\n\"Removable Media\",\t\"MP.L2-3.8.7\",\t\"Media Protection\",\t\"3.8.7\",\t\"MP-7\",\t\"Intune/Microsoft Endpoint Manager\",\t\"Azure Information Protection\",\r\n\"Shared Media\",\t\"MP.L2-3.8.8\",\t\"Media Protection\",\t\"3.8.8\",\t\"MP-7(1)\",\t\"Intune/Microsoft Endpoint Manager\",\t\"Conditional Access\",\r\n\"Protect Backups\",\t\"MP.L2-3.8.9\",\t\"Media Protection\",\t\"3.8.9\",\t\"CP-9\",\t\"Microsoft Azure Portal\",\t\"Azure Key Vault\",\r\n\"Screen Individuals\",\t\"PS.L2-3.9.1\",\t\"Personnel Security\",\t\"3.9.1\",\t\"PS-3 | PS-4 | PS-5\",\t\"NA\",\t\"NA\",\r\n\"Personnel Actions\",\t\"PS.L2-3.9.2\",\t\"Personnel Security\",\t\"3.9.2\",\t\"PS-3 | PS-4 | PS-5\",\t\"Azure Active Directory\",\t\"Azure Information Protection | Intune/Microsoft Endpoint Manager | Microsoft Defender for Cloud Apps | Microsoft 365 Insider Risk Management\",\r\n\"Limit Physical Access\",\t\"PE.L1-3.10.1\",\t\"Physical Protection\",\t\"3.10.1\",\t\"PE\",\t\"Azure Datacenter\",\t\"NA\",\r\n\"Escort Visitors\",\t\"PE.L1-3.10.3\",\t\"Physical Protection\",\t\"3.10.3\",\t\"PE\",\t\"Azure Datacenter\",\t\"NA\",\r\n\"Physical Access Logs\",\t\"PE.L1-3.10.4\",\t\"Physical Protection\",\t\"3.10.4\",\t\"PE\",\t\"Azure Datacenter\",\t\"NA\",\r\n\"Manage Physical Access\",\t\"PE.L1-3.10.5\",\t\"Physical Protection\",\t\"3.10.5\",\t\"PE\",\t\"Azure Datacenter\",\t\"NA\",\r\n\"Monitor Facility\",\t\"PE.L2-3.10.2\",\t\"Physical Protection\",\t\"3.10.2\",\t\"PE\",\t\"Azure Datacenter\",\t\"NA\",\r\n\"Alternative Work Sites\",\t\"PE.L2-3.10.6\",\t\"Physical Protection\",\t\"3.10.6\",\t\"PE-17\",\t\"Azure Datacenter | Intune/Microsoft Endpoint Manager\",\t\"Named Locations | Azure Information Protection | Conditional Access\",\r\n\"Risk Assessments\",\t\"RA.L2-3.11.1\",\t\"Risk Assessment\",\t\"3.11.1\",\t\"RA-3\",\t\"Microsoft Defender for Cloud\",\t\"Microsoft Sentinel | Intune/Microsoft Endpoint Manager | Microsoft Defender for Cloud Apps |  Microsoft Defender for Endpoint\",\r\n\"Vulnerability Scan\",\t\"RA.L2-3.11.2\",\t\"Risk Assessment\",\t\"3.11.2\",\t\"RA-5 | RA-5(5)\",\t\"Microsoft Defender for Cloud | GitHub Enterprise Cloud | GitHub AE | GitHub Advanced Security (Add-On)\",\t\"Azure DNS | Intune/Microsoft Endpoint Manager | Microsoft Defender for Endpoint | Microsoft Defender for Office 365\",\r\n\"Vulnerability Remediation\",\t\"RA.L2-3.11.3\",\t\"Risk Assessment\",\t\"3.11.3\",\t\"RA-5\",\t\"GitHub Advanced Security (Add-On)\",\t\"Microsoft Defender for Cloud | Intune/Microsoft Endpoint Manager | Microsoft Defender for Endpoint | GitHub Enterprise Cloud | GitHub AE\",\r\n\"Security Control Assessment\",\t\"CA.L2-3.12.1\",\t\"Security Assessment\",\t\"3.12.1\",\t\"CA-2 | CA-5 | CA-7 | PL-2\",\t\"Microsoft Defender for Cloud\",\t\"Microsoft Sentinel | Intune/Microsoft Endpoint Manager | Microsoft Defender for Cloud Apps | Microsoft Defender for Endpoint\",\r\n\"Plan of Action\",\t\"CA.L2-3.12.2\",\t\"Security Assessment\",\t\"3.12.2\",\t\"CA-2 | CA-5 | CA-7 | PL-2\",\t\"Microsoft Defender for Endpoint\",\t\"NA\",\r\n\"Security Control Monitoring\",\t\"CA.L2-3.12.3\",\t\"Security Assessment\",\t\"3.12.3\",\t\"CA-2 | CA-5 | CA-7 | PL-2\",\t\"NA\",\t\"Microsoft Sentinel | Intune/Microsoft Endpoint Manager | Microsoft Defender for Cloud Apps | Microsoft Defender for Endpoint | O365 Security and Compliance\",\r\n\"System Security Plan\",\t\"CA.L2-3.12.4\",\t\"Security Assessment\",\t\"3.12.4\",\t\"CA-2 | CA-5 | CA-7 | PL-2\",\t\"NA\",\t\"Microsoft Defender for Cloud\",\r\n\"Boundary Protection\",\t\"SC.L1-3.13.1\",\t\"System & Communications Protection\",\t\"3.13.1\",\t\"SC-15\",\t\"NA\",\t\"Intune/Microsoft Endpoint Manager\",\r\n\"Public-Access System Separation\",\t\"SC.L1-3.13.5\",\t\"System & Communications Protection\",\t\"3.13.5\",\t\"SC-7\",\t\"NA\",\t\"Azure Bastion | Azure Firewall | Load Balancer | Network Security Groups | Azure Web Application Firewall | Virtual Network\",\r\n\"Security Engineering\",\t\"SC.L2-3.13.2\",\t\"System & Communications Protection\",\t\"3.13.2\",\t\"SC-7 | SA-8\",\t\"NA\",\t\"Microsoft Defender for Cloud\",\r\n\"Role Separation\",\t\"SC.L2-3.13.3\",\t\"System & Communications Protection\",\t\"3.13.3\",\t\"SC-2\",\t\"Azure Active Directory\",\t\"Conditional Access | Azure AD Privileged Identity Management\",\r\n\"Shared Resource Control\",\t\"SC.L2-3.13.4\",\t\"System & Communications Protection\",\t\"3.13.4\",\t\"SC-4\",\t\"Azure Information Protection\",\t\"Network Security Groups | Azure Web Application Firewall | Azure Virtual Machines | Virtual Network | Intune/Microsoft Endpoint Manager | Microsoft Defender for Office 365\",\r\n\"Network Communication by Exception\",\t\"SC.L2-3.13.6\",\t\"System & Communications Protection\",\t\"3.13.6\",\t\"SC-7(5)\",\t\"Azure Firewall\",\t\"Microsoft Defender for Cloud | Load Balancer | Network Security Groups | Azure Web Application Firewall | Virtual Network | Intune/Microsoft Endpoint Manager\",\r\n\"Split Tunneling\",\t\"SC.L2-3.13.7\",\t\"System & Communications Protection\",\t\"3.13.7\",\t\"SC-7(7)\",\t\"NA\",\t\"NA\",\r\n\"Data in Transit\",\t\"SC.L2-3.13.8\",\t\"System & Communications Protection\",\t\"3.13.8\",\t\"SC-8 | SC-8(1)\",\t\"Microsoft Azure Portal\",\t\"Azure ExpressRoute | Azure Key Vault | Load Balancer | Network Security Groups | Azure Virtual Machines | Virtual Network | VPN Gateway | Azure Information Protection\",\r\n\"Connections Termination\",\t\"SC.L2-3.13.9\",\t\"System & Communications Protection\",\t\"3.13.9\",\t\"SC-10\",\t\"NA\",\t\"Microsoft Azure Portal | Azure Virtual Machines | VPN Gateway | Azure Active Directory\",\r\n\"Key Management\",\t\"SC.L2-3.13.10\",\t\"System & Communications Protection\",\t\"3.13.10\",\t\"SC-12\",\t\"Azure Key Vault | Azure Information Protection | GitHub Enterprise Cloud | GitHub AE\",\t\"Azure Active Directory\",\r\n\"CUI Encryption\",\t\"SC.L2-3.13.11\",\t\"System & Communications Protection\",\t\"3.13.11\",\t\"SC-13\",\t\"Azure Key Vault\",\t\"Microsoft Azure Portal | Azure Firewall | Azure Virtual Machines | Azure Information Protection | Intune/Microsoft Endpoint Manager | GitHub AE\",\r\n\"Collaborative Device Control\",\t\"SC.L2-3.13.12\",\t\"System & Communications Protection\",\t\"3.13.12\",\t\"SC-15\",\t\"NA\",\t\"Intune/Microsoft Endpoint Manager\",\r\n\"Mobile Code\",\t\"SC.L2-3.13.13\",\t\"System & Communications Protection\",\t\"3.13.13\",\t\"SC-18\",\t\"Microsoft Sentinel | Intune/Microsoft Endpoint Manager\",\t\"Azure Virtual Machines\",\r\n\"Voice over Internet Protocol\",\t\"SC.L2-3.13.14\",\t\"System & Communications Protection\",\t\"3.13.14\",\t\"SC-19\",\t\"Microsoft Teams\",\t\"Microsoft Defender for Cloud\",\r\n\"Communications Authenticity\",\t\"SC.L2-3.13.15\",\t\"System & Communications Protection\",\t\"3.13.15\",\t\"SC-23\",\t\"Microsoft Azure Portal\",\t\"Azure ExpressRoute | Azure Key Vault | Load Balancer | Network Security Groups | Azure Virtual Machines | Virtual Network | VPN Gateway | Azure Information Protection | Intune/Microsoft Endpoint Manager | Microsoft Cloud App Security\",\r\n\"Data at Rest\",\t\"SC.L2-3.13.16\",\t\"System & Communications Protection\",\t\"3.13.16\",\t\"SC-28\",\t\"Azure Key Vault\",\t\"Azure ExpressRoute | Azure Key Vault | Load Balancer | Network Security Groups | Azure Virtual Machines | Virtual Network | VPN Gateway | Azure Information Protection | Intune/Microsoft Endpoint Manager | Microsoft Defender for Cloud Apps\",\r\n\"Flaw Remediation\",\t\"SI.L1-3.14.1\",\t\"System & Information Integrity\",\t\"3.14.1\",\t\"SI-2 | SI-3 | SI-5\",\t\"Microsoft Defender for Cloud | Microsoft Sentinel\",\t\"Intune/Microsoft Endpoint Manager | Microsoft Defender for Endpoint\",\r\n\"Malicious Code Protection\",\t\"SI.L1-3.14.2\",\t\"System & Information Integrity\",\t\"3.14.2\",\t\"SI-2 | SI-3 | SI-5\",\t\"Azure Web Application Firewall | Intune/Microsoft Endpoint Manager | Microsoft Defender for Endpoint\",\t\"Azure DNS | Azure Virtual Machines | Microsoft Defender for Office 365\",\r\n\"Update Malicious Code Protection\",\t\"SI.L1-3.14.4\",\t\"System & Information Integrity\",\t\"3.14.4\",\t\"SI-3\",\t\"Intune/Microsoft Endpoint Manager\",\t\"Azure Virtual Machines | Microsoft Defender for Endpoint | Microsoft Defender for Office 365\",\r\n\"System & File Scanning\",\t\"SI.L1-3.14.5\",\t\"System & Information Integrity\",\t\"3.14.5\",\t\"SI-3\",\t\"Intune/Microsoft Endpoint Manager\",\t\"Azure DNS | Azure Virtual Machines | Microsoft Defender for Cloud Apps | Microsoft Defender for Endpoint | Microsoft Defender for Office 365\",\r\n\"Security Alerts & Advisories\",\t\"SI.L2-3.14.3\",\t\"System & Information Integrity\",\t\"3.14.3\",\t\"SI-2 | SI-3 | SI-5\",\t\"Microsoft Defender for Cloud | Microsoft Sentinel\",\t\"Azure Active Directory | Microsoft Defender for Cloud Apps | Microsoft Defender for Endpoint\",\r\n\"Monitor Communications for Attacks\",\t\"SI.L2-3.14.6\",\t\"System & Information Integrity\",\t\"3.14.6\",\t\"AU-2 | AU-2(3) | AU-6 | SI-4 | SI-4(4)\",\t\"Microsoft Sentinel | Microsoft 365 Defender | Microsoft Defender for Cloud | Microsoft Defender for Cloud Apps \",\t\"Azure DNS | Azure Firewall | Azure Key Vault | Network Security Groups | Azure Web Application Firewall | Virtual Network | Conditional Access | Microsoft Defender for Endpoint | Microsoft Defender for Identity | Microsoft Defender for Office 365\",\r\n\"Identify Unauthorized Use\",\t\"SI.L2-3.14.7\",\t\"System & Information Integrity\",\t\"3.14.7\",\t\"SI-4\",\t\"Microsoft Sentinel | Microsoft Defender for Cloud Apps\",\t\"Azure Bastion | Load Balancer | Network Security Groups | Azure Virtual Machines | VPN Gateway | Azure Active Directory | Microsoft Defender for Endpoint | Azure AD Privileged Identity Management | Microsoft Defender for Office 365\"\r\n];\r\nCrosswalk\r\n| project [\"Control Name\"],[\"Control Number\"],[\"Control Family\"],[\"NIST SP 800-171 R2\"],[\"NIST SP 800-53 R4\"],[\"Primary Services\"],[\"Secondary Services\"]",
              "size": 0,
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Control Name",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "representation": "Persistence",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Primary Services",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "representation": "success",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Secondary Services",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "representation": "pending",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "filter": true
              }
            },
            "name": "query - 1"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isRCAVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Controls Mapping"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# [Access Control](https://www.acq.osd.mil/cmmc/index.html) \r\n---\r\nAccess Control is the process of authorizing users, groups, and computers to access objects on a network, asset, and/or cloud. Key concepts that make up access control are permissions, ownership of objects, inheritance of permissions, user rights, and object auditing.\r\n\r\n"
            },
            "customWidth": "40",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Control\\\": \\\"Authorized Access Control (AC.L1-3.1.1) \\\", \\\"tab\\\": \\\"ACL1311.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Transaction & Function Control (AC.L1-3.1.2)\\\", \\\"tab\\\": \\\"ACL1312.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"External Connections (AC.L1-3.1.20)\\\", \\\"tab\\\": \\\"ACL13120.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Control Public Information (AC.L1-3.1.22)\\\", \\\"tab\\\": \\\"ACL13122.\\\" }\\r\\n]\",\"transformers\":null}",
                    "size": 3,
                    "title": "Level 1: Foundational",
                    "exportMultipleValues": true,
                    "exportedParameters": [
                      {
                        "fieldName": "tab",
                        "parameterName": "Tab",
                        "parameterType": 1
                      }
                    ],
                    "queryType": 8,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tab",
                          "formatter": 5
                        }
                      ]
                    }
                  },
                  "customWidth": "40",
                  "name": "query - 8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "a206a547-329b-4003-8832-c16daacca6c6",
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL1311Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL1311.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL1312Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL1312.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "2d395ae1-35fa-47b7-96fd-3c9b038a7226"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL13120Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL13120.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "9ebfa70c-22df-4445-8b1c-7112129c7be8"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL13122Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL13122.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "0df1cfb7-2b39-45bd-adde-5ea8d922ccdc"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "10",
                  "name": "Hidden Parameters Selectors"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [Authorized Access Control (AC.L1-3.1.1)](https://docs.microsoft.com/azure/governance/policy/samples/nist-sp-800-171-r2#limit-system-access-to-authorized-users-processes-acting-on-behalf-of-authorized-users-and-devices-including-other-systems)\r\n\r\nLimit information system access to authorized users, processes acting on behalf of authorized users, or devices (including other information systems).\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] authorized users are identified;<br>\r\n[b] processes acting on behalf of authorized users are identified;<br>\r\n[c] devices (and other systems) authorized to connect to the system are identified;<br>\r\n[d] system access is limited to authorized users;<br>\r\n[e] system access is limited to processes acting on behalf of authorized users; and<br>\r\n[f] system access is limited to authorized devices (including other systems)<br>\r\n\r\n\r\n"
                              },
                              "name": "text - 2"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Azure Entra ID](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Entra ID Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   🔀[Azure Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n✳️ [Customer Lockbox](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)   🔀[Customer Lockbox](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview)<br>\r\n✳️ [Azure Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   🔀[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n✳️ [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   🔀[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n\r\n\r\n\r\n\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 2",
                        "styleSettings": {
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment"
                        },
                        "name": "text - 5"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "AC_3_1_1_ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "AC_3_1_1_Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "AC_3_1_1_ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "AC_3_1_1_EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "value": "\r\n"
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "AC_3_1_1_Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": ""
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "crossComponentResources": [
                            "/subscriptions/1c2186e8-24b7-4886-af84-e3b7ab6116d1/resourcegroups/cmmc-rg1/providers/microsoft.operationalinsights/workspaces/cmmcws"
                          ],
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Passed"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.1' and Status == '{selectState}'",
                          "size": 1,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "ComplianceStandard",
                                "label": "Compliance Standard Name"
                              },
                              {
                                "columnId": "ComplianceControl",
                                "label": "Control"
                              },
                              {
                                "columnId": "ControlDescription",
                                "label": "Description"
                              },
                              {
                                "columnId": "ControlDetailsLink",
                                "label": "Link"
                              },
                              {
                                "columnId": "Status",
                                "label": "Status"
                              }
                            ]
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL1311Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L1-3.1.1",
                  "styleSettings": {
                    "margin": "3",
                    "padding": "3",
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [Transaction & Function Control (AC.L1-3.1.2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#limit-information-system-access-to-the-types-of-transactions-and-functions-that-authorized-users-are-permitted-to-execute)\r\n\r\nLimit information system access to the types of transactions and functions that authorized users are permitted to execute. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] the types of transactions and functions that authorized users are permitted to execute are defined; and<br>\r\n[b] system access is limited to the defined types of transactions and functions for authorized users.<br>\r\n \r\n"
                              },
                              "name": "text - 2"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   🔀[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n✳️ [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   🔀[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n✳️ [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   🔀[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n✳️ [GitHub Enterprise Cloud](https://github.com/enterprise)   🔀[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n✳️ [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   🔀[GitHub](https://github.com/)<br>\r\n\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment"
                        },
                        "name": "text - 5"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "60",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Passed"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.2' and Status == '{selectState}'",
                          "size": 1,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "ComplianceStandard",
                                "label": "Compliance Standard Name"
                              },
                              {
                                "columnId": "ComplianceControl",
                                "label": "Control "
                              },
                              {
                                "columnId": "ControlDescription",
                                "label": "Description"
                              },
                              {
                                "columnId": "ControlDetailsLink",
                                "label": "Link"
                              },
                              {
                                "columnId": "Status",
                                "label": "Status"
                              }
                            ]
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL1312Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L1-3.1.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [External Connections (AC.L1-3.1.20)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#verify-and-controllimit-connections-to-and-use-of-external-information-systems)\r\n\r\nVerify and control/limit connections to and use of external information systems. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough of Networking/Firewall/Access Controls:<br>  \r\n<p style=\"margin-left: 50px;\">[a] connections to external systems are identified;<br>\r\n[b] the use of external systems is identified;<br>\r\n[c] connections to external systems are verified;<br>\r\n[d] the use of external systems is verified;<br>\r\n[e] connections to external systems are controlled/limited; and<br>\r\n[f] the use of external systems is controlled/limited.<br>\r\n "
                              },
                              "name": "text - 2"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    🔀[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n✳️ [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   🔀[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n✳️ [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   🔀[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n✳️ [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   🔀[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment"
                        },
                        "name": "text - 5"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "60",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.20' and Status == '{selectState}'",
                          "size": 1,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ]
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL13120Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L1-3.1.20",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "# Control Public Information (AC.L1-3.1.22)\r\n\r\nControl information posted or processed on publicly accessible information systems.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] individuals authorized to post or process information on publicly accessible systems are identified;<br>\r\n[b] procedures to ensure FCI is not posted or processed on publicly accessible systems are identified;<br>\r\n[c] a review process is in place prior to posting of any content to publicly accessible systems;<br>\r\n[d] content on publicly accessible systems is reviewed to ensure that it does not include FCI; and<br>\r\n[e] mechanisms are in place to remove and address improper posting of FCI.<br>\r\n"
                                    },
                                    "name": "text - 2"
                                  }
                                ]
                              },
                              "customWidth": "50",
                              "name": "group - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   🔀[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 1"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment"
                              },
                              "name": "text - 3"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Ownership",
                                    "type": 1,
                                    "description": "define who owns control",
                                    "value": "",
                                    "label": "Ownership/Approval"
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [],
                                      "allowCustom": true
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "EvidenceLocation",
                                    "label": "Location for Evidence",
                                    "type": 1,
                                    "description": "Links to where control evidence or reports located",
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    }
                                  },
                                  {
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "customWidth": "60",
                              "name": "Status"
                            }
                          ]
                        },
                        "name": "OV"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.22' and Status == '{selectState}'",
                          "size": 1,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL13122Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L1-3.1.22",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "Level 1: Foundational"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Control\\\": \\\"Control CUI Flow (AC.L2-3.1.3)\\\", \\\"tab\\\": \\\"ACL2313.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Separation of Duties (AC.L2-3.1.4)\\\", \\\"tab\\\": \\\"ACL2314.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Least Privilege (AC.L2-3.1.5)\\\", \\\"tab\\\": \\\"ACL2315.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Non-Privileged Account Use (AC.L2-3.1.6)\\\", \\\"tab\\\": \\\"ACL2316.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Privileged Functions (AC.L2-3.1.7)\\\", \\\"tab\\\": \\\"ACL2317.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Unsuccessful Logon Attempts (AC.L2-3.1.8)\\\", \\\"tab\\\": \\\"ACL2318.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Privacy & Security Notices (AC.L2-3.1.9)\\\", \\\"tab\\\": \\\"ACL2319.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Session Lock (AC.L2-3.1.10)\\\", \\\"tab\\\": \\\"ACL23110.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Session Termination (AC.L2-3.1.11)\\\", \\\"tab\\\": \\\"ACL23111.\\\" }\\r\\n]\",\"transformers\":null}",
                    "size": 3,
                    "title": "Level 2: Advanced",
                    "exportMultipleValues": true,
                    "exportedParameters": [
                      {
                        "fieldName": "tab",
                        "parameterName": "Tab",
                        "parameterType": 1
                      }
                    ],
                    "queryType": 8,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tab",
                          "formatter": 5
                        }
                      ]
                    }
                  },
                  "customWidth": "40",
                  "name": "query - 8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "a206a547-329b-4003-8832-c16daacca6c6",
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL2313Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL2313.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL2314Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL2314.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "34825a5b-616a-43e6-86f7-dfaaec89f6c5"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL2315Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL2315.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "f8eec0a4-8207-40a4-b2e5-5d3a3c3f43ff"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL2316Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL2316.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "901b782d-9d5f-4496-acff-14eba10dfdcc"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL2317Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL2317.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "e7504687-2c9a-4821-8073-10ee5e23023a"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL2318Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL2318.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "21b09f0f-6ebb-437f-b8dc-0bb14bebd757"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL2319Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL2319.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "607fb3ad-cdea-44d8-b578-07a2749629ab"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23110Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23110.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "4e0b74e2-8db0-47b9-ba59-33663592db04"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23111Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23111.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "370d2451-c722-4bed-9124-50016092da87"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "10",
                  "name": "Hidden Parameters Selectors"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Control\\\": \\\"Control Remote Access (AC.L2-3.1.12)\\\", \\\"tab\\\": \\\"ACL23112.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Remote Access Confidentiality (AC.L2-3.1.13)\\\", \\\"tab\\\": \\\"ACL23113.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Remote Access Routing (AC.L2-3.1.14)\\\", \\\"tab\\\": \\\"ACL23114.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Privileged Remote Access (AC.L2-3.1.15)\\\", \\\"tab\\\": \\\"ACL23115.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Wireless Access Authorization (AC.L2-3.1.16)\\\", \\\"tab\\\": \\\"ACL23116.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Wireless Access Protection (AC.L2-3.1.17)\\\", \\\"tab\\\": \\\"ACL23117.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Mobile Device Connection (AC.L2-3.1.18)\\\", \\\"tab\\\": \\\"ACL23118.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Encrypt CUI on Mobile (AC.L2-3.1.19)\\\", \\\"tab\\\": \\\"ACL23119.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Portable Storage Use (AC.L2-3.1.21)\\\", \\\"tab\\\": \\\"ACL23121.\\\" }\\r\\n]\",\"transformers\":null}",
                    "size": 3,
                    "title": "Level 2: Advanced",
                    "exportMultipleValues": true,
                    "exportedParameters": [
                      {
                        "fieldName": "tab",
                        "parameterName": "Tab",
                        "parameterType": 1
                      }
                    ],
                    "queryType": 8,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tab",
                          "formatter": 5
                        }
                      ]
                    }
                  },
                  "customWidth": "40",
                  "name": "query - 8 - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "30560f02-4a96-4628-8600-bccdd3728ad5",
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23112Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23112.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23113Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23113.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "e5c99657-f0a4-4e90-abc2-7c5c27b30f58"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23114Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23114.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "9d45c4e1-9609-48af-8e1b-f7303ce8b698"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23115Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23115.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "b461aaf0-2be5-4930-9feb-d287c4cb7327"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23116Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23116.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "a689497a-5981-48dd-b928-179500bbb146"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23117Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23117.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "b34f76b2-5540-4ecb-b51c-175ed759105f"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23118Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23118.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "651933a2-04a4-4f48-a5f8-3c26dc8be4f8"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23119Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23119.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "6acb347d-36a1-4aab-a3f2-08122beb8ad2"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isACL23121Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "ACL23121.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "d282094f-2bbd-421f-a8d8-90e104966e11"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "10",
                  "name": "Hidden Parameters Selectors - Copy"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [Control CUI Flow (AC.L2-3.1.3)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#control-the-flow-of-cui-in-accordance-with-approved-authorizations)\r\n\r\nControl the flow of CUI in accordance with approved authorizations. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] information flow control policies are defined;<br>\r\n[b] methods and enforcement mechanisms for controlling the flow of CUI are defined;<br>\r\n[c] designated sources and destinations (e.g., networks, individuals, and devices) for CUI within the system and between interconnected systems are identified;<br>\r\n[d] authorizations for controlling the flow of CUI are defined; and<br>\r\n[e] approved authorizations for controlling the flow of CUI are enforced.<br>"
                              },
                              "name": "text - 2"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Aplicable Microsoft Services\r\n✳️ [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   🔀 [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n✳️ [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)    🔀[Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade)<br>\r\n✳️ [Microsoft Information Protection](https://azure.microsoft.com/services/information-protection/)    🔀[Microsoft 365 Compliance Manager](https://compliance.microsoft.com/informationprotection)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   🔀[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   🔀 [Microsoft Defender for Cloud Apps](https://portal.cloudappsecurity.com/)<br>\r\n✳️ [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   🔀[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50%"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 5"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Implemented"
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Failed"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.3' and Status == '{selectState}'",
                          "size": 1,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "/subscriptions/1c2186e8-24b7-4886-af84-e3b7ab6116d1/resourcegroups/cmmc-rg1/providers/microsoft.operationalinsights/workspaces/cmmcws"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL2313Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [Separation of Duties (AC.L2-3.1.4)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#separate-the-duties-of-individuals-to-reduce-the-risk-of-malevolent-activity-without-collusion)\r\n\r\nSeparate the duties of individuals to reduce the risk of malevolent activity without collusion.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] the duties of individuals requiring separation are defined;<br>\r\n[b] responsibilities for duties that require separation are assigned to separate individuals; and<br>\r\n[c] access privileges that enable individuals to exercise the duties that require separation are granted to separate individuals.<br>"
                              },
                              "name": "text - 2"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "group - 2"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   🔀[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n"
                              },
                              "name": "text - 1"
                            }
                          ]
                        },
                        "customWidth": "50",
                        "name": "OV"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 5"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Implemented"
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.4' and Status == '{selectState}'",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL2314Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.4",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "# [Least Privilege (AC.L2-3.1.5)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#employ-the-principle-of-least-privilege-including-for-specific-security-functions-and-privileged-accounts)\r\n\r\nEmploy the principle of least privilege, including for specific security functions and privileged accounts.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] privileged accounts are identified;<br> \r\n[b] access to privileged accounts is authorized in accordance with the principle of least privilege;<br> \r\n[c] security functions are identified; and<br> \r\n[d] access to security functions is authorized in accordance with the principle of least privilege.<br>\r\n"
                                    },
                                    "name": "text - 2"
                                  }
                                ]
                              },
                              "customWidth": "50",
                              "name": "group - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   🔀[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [GitHub Enterprise Cloud](https://github.com/enterprise)   🔀[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n✳️ [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   🔀[GitHub](https://github.com/)<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 1"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 3"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": "Implemented"
                                  },
                                  {
                                    "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Ownership",
                                    "type": 1,
                                    "description": "define who owns control",
                                    "value": "",
                                    "label": "Ownership/Approval"
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [],
                                      "allowCustom": true
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "EvidenceLocation",
                                    "label": "Location for Evidence",
                                    "type": 1,
                                    "description": "Links to where control evidence or reports located",
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    }
                                  },
                                  {
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "customWidth": "75",
                              "name": "Status"
                            }
                          ]
                        },
                        "name": "OV"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Passed"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.5' and Status == '{selectState}'",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "/subscriptions/1c2186e8-24b7-4886-af84-e3b7ab6116d1/resourcegroups/cmmc-rg1/providers/microsoft.operationalinsights/workspaces/cmmcws"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL2315Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Non-Privileged Account Use (AC.L2-3.1.6)\r\n\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] nonsecurity functions are identified; and<br>\r\n[b] users are required to use non-privileged accounts or roles when accessing nonsecurity functions.<br>"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "\r\n\r\n## Applicable Microsoft Services\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   🔀[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n"
                                    },
                                    "name": "text - 1"
                                  }
                                ]
                              },
                              "customWidth": "50",
                              "name": "OV"
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Implemented"
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.6' and Status == '{selectState}'",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RecommendationName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true,
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "RecommendationLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "OpenBlade",
                                  "linkLabel": "Remediate >>",
                                  "linkIsContextBlade": false,
                                  "bladeOpenContext": {
                                    "bladeName": "RecommendationsBlade",
                                    "extensionName": "Microsoft_Azure_Security",
                                    "bladeParameters": [
                                      {
                                        "name": "assessmentKey",
                                        "source": "column",
                                        "value": "recommendationName1"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "recommendationName1",
                                "formatter": 5
                              }
                            ]
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL2316Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "# [Privileged Functions (AC.L2-3.1.7)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#prevent-non-privileged-users-from-executing-privileged-functions-and-capture-the-execution-of-such-functions-in-audit-logs)\r\n\r\nPrevent non-privileged users from executing privileged functions and capture the execution of such functions in audit logs.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] privileged functions are defined;<br>\r\n[b] non-privileged users are defined;<br>\r\n[c] non-privileged users are prevented from executing privileged functions; and<br>\r\n[d] the execution of privileged functions is captured in audit logs.<br>"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "## Applicable Microsoft Services\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   🔀[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   🔀[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n✳️ [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   🔀[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 1"
                                  }
                                ]
                              },
                              "name": "group - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": "Implemented"
                                  },
                                  {
                                    "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Ownership",
                                    "type": 1,
                                    "description": "define who owns control",
                                    "value": "",
                                    "label": "Ownership/Approval"
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [],
                                      "allowCustom": true
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "EvidenceLocation",
                                    "label": "Location for Evidence",
                                    "type": 1,
                                    "description": "Links to where control evidence or reports located",
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    }
                                  },
                                  {
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "customWidth": "75",
                              "name": "Status"
                            }
                          ]
                        },
                        "name": "OV"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.7' and Status == '{selectState}'",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL2317Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.7",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "# Unsuccessful Logon Attempts (AC.L2-3.1.8)\r\n\r\nLimit unsuccessful logon attempts. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] the means of limiting unsuccessful logon attempts is defined; and<br>\r\n[b] the defined means of limiting unsuccessful logon attempts is implemented.<br>"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "## Applicable Microsoft Services\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   🔀[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>✳️ [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   🔀[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n✳️ [Password Protection for Azure AD](https://docs.microsoft.com/azure/active-directory/authentication/howto-password-ban-bad-on-premises-deploy)   🔀[Azure AD Password Protection](https://portal.azure.com/#blade/Microsoft_AAD_IAM/PasswordProtectionBlade)<br>\r\n\r\n"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 1"
                                  }
                                ]
                              },
                              "name": "group - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": "Implemented"
                                  },
                                  {
                                    "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Ownership",
                                    "type": 1,
                                    "description": "define who owns control",
                                    "value": "",
                                    "label": "Ownership/Approval"
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [],
                                      "allowCustom": true
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "EvidenceLocation",
                                    "label": "Location for Evidence",
                                    "type": 1,
                                    "description": "Links to where control evidence or reports located",
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    }
                                  },
                                  {
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "name": "Status"
                            }
                          ]
                        },
                        "name": "OV"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.8' and Status == '{selectState}'",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "/subscriptions/1c2186e8-24b7-4886-af84-e3b7ab6116d1/resourcegroups/cmmc-rg1/providers/microsoft.operationalinsights/workspaces/cmmcws"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL2318Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# Privacy & Security Notices (AC.L2-3.1.9)\r\n\r\nProvide privacy and security notices consistent with applicable CUI rules.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] privacy and security notices required by CUI-specified rules are identified, consistent, and associated with the specific CUI category; and<br>\r\n[b] privacy and security notices are displayed.<br> \r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    🔀[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n✳️ [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   🔀[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 1",
                              "styleSettings": {
                                "margin": "2",
                                "padding": "2",
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Implemented"
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.9' and Status == '{selectState}'",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Description",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL2319Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.9",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "# Session Lock (AC.L2-3.1.10) \r\n\r\nUse session lock with pattern-hiding displays to prevent access and viewing of data after a period of inactivity. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] the period of inactivity after which the system initiates a session lock is defined;<br>\r\n[b] access to the system and viewing of data is prevented by initiating a session lock after the defined period of inactivity; and<br>\r\n[c] previously visible information is concealed via a pattern-hiding display after the defined period of inactivity.<br>"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    🔀[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n✳️ [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   🔀[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Configuration\r\n💡 [Configure screen lock settings using Intune](https://docs.microsoft.com/mem/intune/configuration/device-restrictions-windows-10#locked-screen-experience)<br>\r\n💡 [Grant access to resources if devices are marked as compliant](https://docs.microsoft.com/azure/active-directory/conditional-access/require-managed-devices#require-device-to-be-marked-as-compliant)<br>\r\n💡 [Conceal Passwords with Password Box](https://docs.microsoft.com/windows/uwp/design/controls-and-patterns/password-box)<br>\r\n"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 1"
                                  }
                                ]
                              },
                              "name": "group - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": "Implemented"
                                  },
                                  {
                                    "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Ownership",
                                    "type": 1,
                                    "description": "define who owns control",
                                    "value": "",
                                    "label": "Ownership/Approval"
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [],
                                      "allowCustom": true
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "EvidenceLocation",
                                    "label": "Location for Evidence",
                                    "type": 1,
                                    "description": "Links to where control evidence or reports located",
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    }
                                  },
                                  {
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "customWidth": "75",
                              "name": "Status"
                            }
                          ]
                        },
                        "name": "OV"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.10' and Status == '{selectState}'",
                          "size": 4,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Description",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Total",
                                "formatter": 22,
                                "formatOptions": {
                                  "compositeBarSettings": {
                                    "labelText": "",
                                    "columnSettings": [
                                      {
                                        "columnName": "Passed",
                                        "color": "green"
                                      },
                                      {
                                        "columnName": "Failed",
                                        "color": "redBright"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "PassedControls",
                                "formatter": 0,
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal",
                                    "maximumFractionDigits": 2
                                  }
                                }
                              },
                              {
                                "columnMatch": "RecommendationDisplayName",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ControlNumber",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "representation": "AllServices",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "RecommendationState",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "!=",
                                      "thresholdValue": "Healthy",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "representation": "success",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "count_",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue"
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23110Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.10",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "# Session Termination (AC.L2-3.1.11) \r\n\r\nTerminate (automatically) a user session after a defined condition.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] conditions requiring a user session to terminate are defined; and<br>\r\n[b] a user session is automatically terminated after any of the defined conditions occur. <br>"
                                    },
                                    "name": "text - 2"
                                  }
                                ]
                              },
                              "customWidth": "50",
                              "name": "group - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    🔀[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n✳️ [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   🔀[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n✳️ [Application Gateway](https://azure.microsoft.com/services/application-gateway/)   🔀 [Application Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) <br>\r\n✳️ [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   🔀[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 1"
                            }
                          ]
                        },
                        "name": "OV"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              },
                              "value": "Implemented"
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.11' and Status == '{selectState}'",
                          "size": 1,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ]
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23111Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.11",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [Control Remote Access (AC.L2-3.1.12)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#monitor-and-control-remote-access-sessions)\r\n\r\nMonitor and control remote access sessions.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] remote access sessions are permitted;<br>\r\n[b] the types of permitted remote access are identified;<br>\r\n[c] remote access sessions are controlled; and<br>\r\n[d] remote access sessions are monitored.<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   🔀[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n✳️ [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   🔀[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    🔀[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n✳️ [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   🔀[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n✳️ [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   🔀[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n✳️ [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   🔀[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   🔀[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 1",
                              "styleSettings": {
                                "margin": "2",
                                "padding": "2",
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Passed"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.12' and Status == '{selectState}'",
                          "size": 1,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ]
                          }
                        },
                        "name": "query - 2"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23112Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.12",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# Remote Access Confidentiality (AC.L2-3.1.13)\r\n\r\nEmploy cryptographic mechanisms to protect the confidentiality of remote access sessions.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] cryptographic mechanisms to protect the confidentiality of remote access sessions are identified; and<br>\r\n[b] cryptographic mechanisms to protect the confidentiality of remote access sessions are implemented.<br>"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Azure Portal](https://azure.microsoft.com/services/azure-defender-for-iot/)    🔀[Microsoft Azure Portal](https://portal.azure.com/)<br>\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Multi-Factor Authentication](https://azure.microsoft.com/services/active-directory/)    🔀[Multi-Factor Authentication](https://portal.azure.com/#blade/Microsoft_AAD_IAM/MultifactorAuthenticationMenuBlade/GettingStarted)<br>\r\n✳️ [Load Balancer]( https://azure.microsoft.com/services/load-balancer/)   🔀[Load Balancers](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)<br>\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 1",
                              "styleSettings": {
                                "margin": "2",
                                "padding": "2",
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Passed"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.13' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23113Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.13",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [Privileged Remote Access (AC.L2-3.1.14)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#route-remote-access-via-managed-access-control-points)\r\n\r\nRoute remote access via managed access control points.Control Assessment\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] managed access control points are identified and implemented; and<br>\r\n[b] remote access is routed through managed network access control points.<br>"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Azure Bastion](https://azure.microsoft.com/services/azure-bastion/)   🔀[Bastions](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FbastionHosts)<br>\r\n✳️ [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)   🔀[Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/)   🔀[ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)<br>\r\n✳️ [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   🔀[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n✳️ [Azure Front Door](https://azure.microsoft.com/services/frontdoor/)   🔀[Front Doors](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/frontdoors)<br>\r\n✳️ [Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)   🔀[Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups)<br>\r\n✳️ [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   🔀 [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n✳️ [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   🔀[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 1",
                              "styleSettings": {
                                "margin": "2",
                                "padding": "2",
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Passed"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.14' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "noDataMessage": "No matching data returned",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - 4"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23114Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.14",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [Privileged Remote Access (AC.L2-3.1.15)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#authorize-remote-execution-of-privileged-commands-and-remote-access-to-security-relevant-information)\r\n\r\nAuthorize remote execution of privileged commands and remote access to security-relevant information. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] privileged commands authorized for remote execution are identified;<br>\r\n[b] security-relevant information authorized to be accessed remotely is identified;<br>\r\n[c] the execution of the identified privileged commands via remote access is authorized; and<br>\r\n[d] access to the identified security-relevant information via remote access is authorized.<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Azure AD Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started)   🔀[Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   🔀[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n✳️ [Virtual Machines](https://azure.microsoft.com/services/virtual-machines/)   🔀[Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines)<br>\r\n✳️ [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   🔀[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 1",
                              "styleSettings": {
                                "margin": "2",
                                "padding": "2",
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.15' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "noDataMessage": "No matching data returned",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "name": "query - 4"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23115Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.15",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# Wireless Access Authorization (AC.L2-3.1.16) \r\n\r\nAuthorize wireless access prior to allowing such connections.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] wireless access points are identified; and<br>\r\n[b] wireless access is authorized prior to allowing such connections.<br>"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Configuration\r\n💡 [Network Access Control (NAC)](https://docs.microsoft.com/mem/intune/protect/network-access-control-integrate)<br>\r\n💡 [Grant access to resources if devices are marked as compliant](https://docs.microsoft.com/azure/active-directory/conditional-access/)<br>\r\n💡 [Conditional Access with Intune](https://docs.microsoft.com/mem/intune/protect/conditional-access-intune-common-ways-use)\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 1",
                              "styleSettings": {
                                "margin": "2",
                                "padding": "2",
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.16' and Status == '{selectState}'",
                          "size": 4,
                          "showAnalytics": true,
                          "noDataMessage": "No results",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Description",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23116Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.16",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "# Wireless Access Protection (AC.L2-3.1.17) \r\n\r\nProtect wireless access using authentication and encryption. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] wireless access to the system is protected using authentication; and <br> \r\n[b] wireless access to the system is protected using encryption.<br>"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "## Applicable Microsoft Services\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Configuration\r\n💡 [Use a Custom Device Profile to Create a WiFi Profile with a Pre-Shared Key in Intune](https://docs.microsoft.com/mem/intune/configuration/wi-fi-profile-shared-key)<br>\r\n💡 [Using NAC with Conditional Access & Intune](https://docs.microsoft.com/mem/intune/protect/conditional-access-intune-common-ways-use)\r\n\r\n"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 1",
                                    "styleSettings": {
                                      "margin": "0",
                                      "padding": "0"
                                    }
                                  }
                                ]
                              },
                              "name": "group - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Ownership",
                                    "type": 1,
                                    "description": "define who owns control",
                                    "value": "",
                                    "label": "Ownership/Approval"
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [],
                                      "allowCustom": true
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "EvidenceLocation",
                                    "label": "Location for Evidence",
                                    "type": 1,
                                    "description": "Links to where control evidence or reports located",
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    }
                                  },
                                  {
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "customWidth": "75",
                              "name": "Status"
                            }
                          ]
                        },
                        "name": "OV"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.17' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "noDataMessage": "No data match",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Description",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23117Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.17",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "# Mobile Device Connection (AC.L2-3.1.18) \r\n\r\nControl connection of mobile devices.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] mobile devices that process, store, or transmit CUI are identified;<br>\r\n[b] mobile device connections are authorized; and<br>\r\n[c] mobile device connections are monitored and logged.<br>\r\n"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "## Applicable Microsoft Services\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   🔀[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 1",
                                    "styleSettings": {
                                      "margin": "0px",
                                      "padding": "0px"
                                    }
                                  }
                                ]
                              },
                              "name": "group - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Ownership",
                                    "type": 1,
                                    "description": "define who owns control",
                                    "value": "",
                                    "label": "Ownership/Approval"
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 4,
                                    "typeSettings": {
                                      "selectableValues": [],
                                      "allowCustom": true
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "EvidenceLocation",
                                    "label": "Location for Evidence",
                                    "type": 1,
                                    "description": "Links to where control evidence or reports located",
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    }
                                  },
                                  {
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text",
                                      "multiLineHeight": 3
                                    },
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "customWidth": "75",
                              "name": "Status"
                            }
                          ]
                        },
                        "name": "OV"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.18' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "noDataMessage": "No data returned",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "name": "query - 9"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23118Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.18",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "# Encrypt CUI on Mobile (AC.L2-3.1.19) \r\n\r\nEncrypt CUI on mobile devices and mobile computing platforms. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] mobile devices and mobile computing platforms that process, store, or transmit CUI are identified; and<br>\r\n[b] encryption is employed to protect CUI on identified mobile devices and mobile computing platforms.<br>"
                        },
                        "customWidth": "50",
                        "name": "text - 1",
                        "styleSettings": {
                          "margin": "2",
                          "padding": "2",
                          "maxWidth": "50"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Applicable Microsoft Services\r\n✳️ [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   🔀[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n## Recommended Configurations\r\n💡 [How to Create and Assign App Protection Policies](https://docs.microsoft.com/mem/intune/apps/app-protection-policies)<br>\r\n💡 [App Protection Policies Overview](https://docs.microsoft.com/mem/intune/apps/app-protection-policy)<br> \r\n💡 [Microsoft Intune Protected Apps](https://docs.microsoft.com/mem/intune/apps/apps-supported-intune-apps)<br> \r\n💡 [Data Protection Framework Using App Protection Policies](https://docs.microsoft.com/mem/intune/apps/app-protection-framework)<br> \r\n\r\n"
                        },
                        "customWidth": "50",
                        "name": "text - 4"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 5"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.19' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "noDataMessage": "No data returned",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - 2"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23119Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.19",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 12,
                              "content": {
                                "version": "NotebookGroup/1.0",
                                "groupType": "editable",
                                "items": [
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "# Portable Storage Use (AC.L2-3.1.21) \r\n\r\nLimit use of portable storage devices on external systems.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] the use of portable storage devices containing CUI on external systems is identified and documented;<br>\r\n[b] limits on the use of portable storage devices containing CUI on external systems are defined; and<br>\r\n[c] the use of portable storage devices containing CUI on external systems is limited as defined.<br>"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 2"
                                  },
                                  {
                                    "type": 1,
                                    "content": {
                                      "json": "## Applicable Microsoft Services\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Named Locations](https://docs.microsoft.com/azure/active-directory/conditional-access/location-condition)   🔀[Azure AD Named Locations](https://portal.azure.com/#blade/Microsoft_AAD_IAM/NamedNetworksWithCountryBlade)<br>\r\n\r\n## Recommended Configuration\r\n💡 [How to Control USB Devices and Other Removable Media Using Microsoft Intune](https://docs.microsoft.com/windows/security/threat-protection/device-control/control-usb-devices-using-intune)<br>\r\n\r\n"
                                    },
                                    "customWidth": "50",
                                    "name": "text - 1",
                                    "styleSettings": {
                                      "margin": "0px",
                                      "padding": "0px"
                                    }
                                  }
                                ]
                              },
                              "name": "group - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Control Assessment\r\n"
                              },
                              "name": "text - 2"
                            },
                            {
                              "type": 9,
                              "content": {
                                "version": "KqlParameterItem/1.0",
                                "parameters": [
                                  {
                                    "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationStatus",
                                    "label": "Implementation Status",
                                    "type": 2,
                                    "typeSettings": {
                                      "showDefault": false
                                    },
                                    "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "value": "Implemented"
                                  },
                                  {
                                    "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "ImplementationDate",
                                    "label": "Implementation Date",
                                    "type": 1,
                                    "value": "",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    }
                                  },
                                  {
                                    "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "EvidenceLocation",
                                    "label": "Location for Evidence",
                                    "type": 1,
                                    "description": "Links to where control evidence or reports located",
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text"
                                    },
                                    "value": ""
                                  },
                                  {
                                    "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Ownership",
                                    "type": 1,
                                    "description": "define who owns control",
                                    "value": "",
                                    "label": "Ownership/Approval"
                                  },
                                  {
                                    "version": "KqlParameterItem/1.0",
                                    "name": "Notes",
                                    "type": 1,
                                    "typeSettings": {
                                      "multiLineText": true,
                                      "editorLanguage": "text"
                                    },
                                    "value": "\r\n",
                                    "timeContext": {
                                      "durationMs": 86400000
                                    },
                                    "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf"
                                  }
                                ],
                                "style": "pills",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces"
                              },
                              "customWidth": "75",
                              "name": "Status"
                            }
                          ]
                        },
                        "name": "OV"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "abb8b90b-cb45-46ae-a643-cba217123957",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.1.21' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "title": "Monitor Portable Storage Devices",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isACL23121Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AC.L2-3.1.21",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "Level 2: Advanced"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isACVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Access Control Group",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# [Audit & Accountability](https://www.acq.osd.mil/cmmc/index.html)\r\n---\r\nAudit & Accountability involves the evaluation of configurable security and logging options to help identify gaps in security policies and mechanisms. "
            },
            "customWidth": "40",
            "name": "text - 5"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Control\\\": \\\"System Auditing (AU.L2-3.3.1)\\\", \\\"tab\\\": \\\"AUL2331.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"User Accountability (AU.L2-3.3.2)\\\", \\\"tab\\\": \\\"AUL2332.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Event Review (AU.L2-3.3.3)\\\", \\\"tab\\\": \\\"AUL2333.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Audit Failure Alerting (AU.L2-3.3.4)\\\", \\\"tab\\\": \\\"AUL2334.\\\" },\\t\\r\\n\\t{ \\\"Control\\\": \\\"Audit Correlation (AU.L2-3.3.5)\\\", \\\"tab\\\": \\\"AUL2335.\\\" }\\r\\n]\",\"transformers\":null}",
                    "size": 3,
                    "title": "Level 2: Advanced",
                    "exportMultipleValues": true,
                    "exportedParameters": [
                      {
                        "fieldName": "tab",
                        "parameterName": "Tab",
                        "parameterType": 1
                      }
                    ],
                    "queryType": 8,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tab",
                          "formatter": 5
                        }
                      ]
                    }
                  },
                  "customWidth": "40",
                  "name": "query - 8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "a206a547-329b-4003-8832-c16daacca6c6",
                        "version": "KqlParameterItem/1.0",
                        "name": "isAUL2331Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "AUL2331.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isAUL2332Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "AUL2332.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "d19637ad-09c9-4a1b-8987-ee2348384fed"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isAUL2333Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "AUL2333.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "ede6dc18-910b-45e4-97a6-ac014c9d397d"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isAUL2334Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "AUL2334.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "bdbc3a5c-37f6-4a1f-9d67-62dd6f8782a5"
                      },
                      {
                        "version": "KqlParameterItem/1.0",
                        "name": "isAUL2335Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "AUL2335.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "id": "96e61cfa-f86e-44e7-b7c8-b5450ee00d53"
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "10",
                  "name": "Hidden Parameters Selectors"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Control\\\": \\\"Reduction & Reporting (AU.L2-3.3.6)\\\", \\\"tab\\\": \\\"AUL2336.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Authoritative Time Source (AU.L2-3.3.7) \\\", \\\"tab\\\": \\\"AUL2337.\\\" },\\r\\n\\t{ \\\"Control\\\": \\\"Audit Protection (AU.L2-3.3.8)\\\", \\\"tab\\\": \\\"AUL2338.\\\" },\\t\\r\\n\\t{ \\\"Control\\\": \\\"Audit Management (AU.L2-3.3.9)\\\", \\\"tab\\\": \\\"AUL2339.\\\" }\\r\\n]\",\"transformers\":null}",
                    "size": 3,
                    "title": "Level 2: Advanced",
                    "exportMultipleValues": true,
                    "exportedParameters": [
                      {
                        "fieldName": "tab",
                        "parameterName": "Tab",
                        "parameterType": 1
                      }
                    ],
                    "queryType": 8,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tab",
                          "formatter": 5
                        }
                      ]
                    }
                  },
                  "customWidth": "40",
                  "name": "query - 8 - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "24e2c8b9-34c1-4559-aaee-0414d9b98420",
                        "version": "KqlParameterItem/1.0",
                        "name": "isAUL2336Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "AUL2336.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "id": "b7b6fd63-9a21-4122-8f7d-6fbcc265a2d6",
                        "version": "KqlParameterItem/1.0",
                        "name": "isAUL2337Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "AUL2337.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "id": "eecb3728-3783-4f86-9074-da005a39a679",
                        "version": "KqlParameterItem/1.0",
                        "name": "isAUL2338Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "AUL2338.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      },
                      {
                        "id": "ce3ab9b5-a1bd-4b29-ae20-63e8c3da2ec2",
                        "version": "KqlParameterItem/1.0",
                        "name": "isAUL2339Visible",
                        "type": 1,
                        "isHiddenWhenLocked": true,
                        "criteriaData": [
                          {
                            "criteriaContext": {
                              "leftOperand": "Tab",
                              "operator": "contains",
                              "rightValType": "static",
                              "rightVal": "AUL2339.",
                              "resultValType": "static",
                              "resultVal": "true"
                            }
                          },
                          {
                            "criteriaContext": {
                              "operator": "Default",
                              "rightValType": "param",
                              "resultValType": "static",
                              "resultVal": "false"
                            }
                          }
                        ],
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "customWidth": "10",
                  "name": "Hidden Parameters Selectors - Copy"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [System Auditing (AU.L2-3.3.1)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#create-and-retain-system-audit-logs-and-records-to-the-extent-needed-to-enable-the-monitoring-analysis-investigation-and-reporting-of-unlawful-or-unauthorized-system-activity)\r\n\r\nCreate and retain system audit logs and records to the extent needed to enable the monitoring, analysis, investigation, and reporting of unlawful or unauthorized system activity. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] audit logs needed (i.e., event types to be logged) to enable the monitoring, analysis, investigation, and reporting of unlawful or unauthorized system activity are specified;<br>\r\n[b] the content of audit records needed to support monitoring, analysis, investigation, and reporting of unlawful or unauthorized system activity is defined;<br>\r\n[c] audit records are created (generated);<br>\r\n[d] audit records, once created, contain the defined content;<br>\r\n[e] retention requirements for audit records are defined; and<br>\r\n[f] audit records are retained as defined.<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Azure Monitor](https://azure.microsoft.com/services/monitor/)   🔀[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   🔀[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n✳️ [Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)   🔀[Azure Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)<br>\r\n✳️ [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   🔀[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n✳️ [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)   🔀 [Web Application Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FFrontDoorWebApplicationFirewallPolicies)<br>\r\n✳️ [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   🔀[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n✳️ [GitHub Enterprise Cloud](https://github.com/enterprise)   🔀[GitHub Enterprise](https://enterprise.github.com/login)<br>\r\n✳️ [GitHub AE](https://docs.github.com/en/github-ae@latest/admin/overview/about-github-ae)   🔀[GitHub](https://github.com/)<br>\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 0",
                              "styleSettings": {
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.3.1' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "DataType",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "name": "query - 3 - Copy - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isAUL2331Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AU.L2-3.3.1",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [User Accountability (AU.L2-3.3.2)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#ensure-that-the-actions-of-individual-system-users-can-be-uniquely-traced-to-those-users-so-they-can-be-held-accountable-for-their-actions)\r\n\r\nEnsure that the actions of individual system users can be uniquely traced to those users, so they can be held accountable for their actions.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] the content of the audit records needed to support the ability to uniquely trace users to their actions is defined; and<br>\r\n[b] audit records, once created, contain the defined content.<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   🔀[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   🔀[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 0",
                              "styleSettings": {
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.3.2' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkIsContextBlade": false
                                }
                              }
                            ],
                            "filter": true
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "name": "query - 9"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isAUL2332Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AU.L2-3.3.2",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# Event Review (AU.L2-3.3.3) \r\n\r\nReview and update logged events.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough of process that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] a process for determining when to review logged events is defined;<br>\r\n[b] event types being logged are reviewed in accordance with the defined review process; and<br>\r\n[c] event types being logged are updated based on the review.<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable iMcrosoft Services\r\n✳️ [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   🔀[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n✳️ [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   🔀 [Microsoft Defender for Cloud Apps](https://portal.cloudappsecurity.com/)<br>\r\n✳️ [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   🔀[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n## Recommended Configurations\r\n💡 [Connect Data Sources](https://docs.microsoft.com/azure/sentinel/connect-data-sources)\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 0",
                              "styleSettings": {
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.3.3' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "noDataMessage": "No matching data returned",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "DataType",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "showBorder": false
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isAUL2333Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AU.L2-3.3.3",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [Audit Failure Alerting (AU.L2-3.3.4)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#alert-in-the-event-of-an-audit-logging-process-failure)\r\n\r\nAlert in the event of an audit logging process failure. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] personnel or roles to be alerted in the event of an audit logging process failure are identified;<br>\r\n[b] types of audit logging process failures for which alert will be generated are defined; and<br>\r\n[c] identified personnel or roles are alerted in the event of an audit logging process failure.<br>"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   🔀[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Intune/Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)   🔀[Microsoft Endpoint Manager Admin Center](https://endpoint.microsoft.com/#home)<br>\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 0",
                              "styleSettings": {
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.3.4' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "title": " ",
                          "noDataMessage": "No matching data returned",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - 2"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isAUL2334Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AU.L2-3.3.4",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# Audit Correlation (AU.L2-3.3.5) \r\n\r\nCorrelate audit record review, analysis, and reporting processes for investigation and response to indications of unlawful, unauthorized, suspicious, or unusual activity.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows verification of:<br>  \r\n<p style=\"margin-left: 50px;\">[a] audit record review, analysis, and reporting processes for investigation and response to indications of unlawful, unauthorized, suspicious, or unusual activity are defined; and<br>\r\n[b] defined audit record review, analysis, and reporting processes are correlated.<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   🔀[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n✳️ [Microsoft Defender for Cloud Apps](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)   🔀 [Microsoft Defender for Cloud Apps](https://portal.cloudappsecurity.com/)<br>\r\n✳️ [Microsoft 365 Defender](https://www.microsoft.com/microsoft-365/security/microsoft-365-defender)   🔀[Microsoft 365 Defender](https://security.microsoft.com/)<br>\r\n✳️ [Azure Monitor](https://azure.microsoft.com/services/monitor/)   🔀[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n✳️ [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   🔀[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n✳️ [Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)   🔀[Microsoft Defender for Identity](https://portal.atp.azure.com/)<br>\r\n✳️ [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)   🔀[Microsoft 365 Defender Portal](https://security.microsoft.com/homepage)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 0",
                              "styleSettings": {
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.3.5' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "noDataMessage": "No matching data returned",
                          "noDataMessageStyle": 4,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 1"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isAUL2335Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AU.L2-3.3.5",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# Reduction & Reporting (AU.L2-3.3.6)\r\n\r\nProvide audit record reduction and report generation to support on-demand analysis and reporting.<br>\r\nAudit record reduction is a process that manipulates collected audit information and organizes such information in a summary format that is more meaningful to analysts. Audit record reduction and report generation capabilities do not always emanate from the same system or organizational entities conducting auditing activities. Audit record reduction capability can include, for example, modern data mining techniques with advanced data filters to identify anomalous behavior in audit records. The report generation capability provided by the system can help generate customizable reports. Time ordering of audit records can be a significant issue if the granularity of the time stamp in the record is insufficient.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] an audit record reduction capability that supports on-demand analysis is provided; and<br>\r\n[b] a report generation capability that supports on-demand reporting is provided.<br>"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   🔀[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center/)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n✳️ [Azure Monitor](https://azure.microsoft.com/services/monitor/)   🔀[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n✳️ [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   🔀[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 0",
                              "styleSettings": {
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.3.6' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SigninStatus",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Count",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "blue"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 2,
                                  "maximumSignificantDigits": 3
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Trend",
                              "formatter": 9,
                              "formatOptions": {
                                "palette": "green"
                              }
                            },
                            "showBorder": false
                          },
                          "mapSettings": {
                            "locInfo": "CountryRegion",
                            "locInfoColumn": "Location",
                            "latitude": "SourceIPLocation",
                            "longitude": "SourceIPLocation",
                            "sizeSettings": "Location",
                            "sizeAggregation": "Count",
                            "legendMetric": "Location",
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "Location",
                              "colorAggregation": "Count",
                              "type": "thresholds",
                              "thresholdsGrid": [
                                {
                                  "operator": "Default",
                                  "representation": "blueDark"
                                }
                              ]
                            }
                          }
                        },
                        "name": "query - 3"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isAUL2336Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AU.L2-3.3.6",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# Authoritative Time Source (AU.L2-3.3.7) \r\n\r\nProvide a system capability that compares and synchronizes internal system clocks with an authoritative source to generate time stamps for audit records.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] internal system clocks are used to generate time stamps for audit records;<br>\r\n[b] an authoritative source with which to compare and synchronize internal system clocks is specified; and<br>\r\n[c] internal system clocks used to generate time stamps for audit records are compared to and synchronized with the specified authoritative time source.<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Microsoft Defender for Cloud](https://azure.microsoft.com/services/security-center)   🔀[Microsoft Defender for Cloud](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)<br>\r\n\r\n## Recommended Configurations\r\n💡 [Time sync for Windows VMs in Azure](https://docs.microsoft.com/azure/virtual-machines/windows/time-sync)\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 0",
                              "styleSettings": {
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.3.7' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Description",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "Default",
                                      "representation": "Gear",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "Caller",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "count_",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "DataType"
                            },
                            "showBorder": false
                          }
                        },
                        "name": "query - 1 - Copy"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isAUL2337Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AU.L2-3.3.7",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# [Audit Protection (AU.L2-3.3.8)](https://docs.microsoft.com/azure/governance/policy/samples/cmmc-l3#protect-audit-information-and-audit-logging-tools-from-unauthorized-access-modification-and-deletion)\r\n\r\nProtect audit information and audit logging tools from unauthorized access, modification, and deletion.\r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] audit information is protected from unauthorized access;<br>\r\n[b] audit information is protected from unauthorized modification;<br>\r\n[c] audit information is protected from unauthorized deletion;<br>\r\n[d] audit logging tools are protected from unauthorized access;<br>\r\n[e] audit logging tools are protected from unauthorized modification; and<br>\r\n[f] audit logging tools are protected from unauthorized deletion.<br>\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Azure Monitor](https://azure.microsoft.com/services/monitor/)   🔀[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n✳️ [Microsoft Sentinel](https://azure.microsoft.com/services/azure-sentinel/)   🔀[Microsoft Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)<br>\r\n✳️ [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   🔀[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n✳️ [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   🔀[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 0",
                              "styleSettings": {
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.3.8' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "title": "Monitor User Audit Logging Tool Access, Modification, and Deletion",
                          "noDataMessage": "An Empty Panel Provides Opportunity To Explore Further and Implement Hardening. Controls: Confirm Licensing, Availability, and Health of Respective Offerings. Logging: Confirm Log Source is Onboarded to the Log Analytics Workspace. Time: Adjust the Time Parameter for a Larger Data-Set.   ",
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "query - 2"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isAUL2338Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AU.L2-3.3.8",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "# Audit Management (AU.L2-3.3.9) \r\n\r\nLimit management of audit logging functionality to a subset of privileged users. \r\n\r\n## Attestation Evidence Guidance\r\n💡 Screenshare/ Walkthrough that shows:<br>  \r\n<p style=\"margin-left: 50px;\">[a] a subset of privileged users granted access to manage audit logging functionality is defined; and<br>\r\n[b] management of audit logging functionality is limited to the defined subset of privileged users.<br>"
                              },
                              "customWidth": "50",
                              "name": "text - 2"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "## Applicable Microsoft Services\r\n✳️ [Azure Monitor](https://azure.microsoft.com/services/monitor/)   🔀[Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview)<br>\r\n✳️ [Azure Active Directory](https://azure.microsoft.com/services/active-directory/)   🔀[Azure Active Directory Portal](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)<br>\r\n✳️ [Conditional Access](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)   🔀[Azure Active Directory: Conditional Access](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)<br>\r\n✳️ [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)   🔀[Microsoft 365 Compliance Management](https://compliance.microsoft.com/)<br>\r\n\r\n\r\n"
                              },
                              "customWidth": "50",
                              "name": "text - 0",
                              "styleSettings": {
                                "maxWidth": "50%"
                              }
                            }
                          ]
                        },
                        "name": "group - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "## Control Assessment\r\n"
                        },
                        "name": "text - 4"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "52668f65-b44a-4e14-82d8-c87410e7e5dc",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationStatus",
                              "label": "Implementation Status",
                              "type": 2,
                              "typeSettings": {
                                "showDefault": false
                              },
                              "jsonData": "[\r\n    {\"value\": \"Not Implemented\", \"label\": \"Not Implemented\", \"selected\":true},\r\n    {\"value\": \"Implemented\", \"label\": \"Implemented\"},\r\n    {\"value\": \"Alternate Implementation\", \"label\": \"Alternate Implementation\"},\r\n    {\"value\": \"Planned\", \"label\": \"Planned\"},\r\n    {\"value\": \"Out of Scope\", \"label\": \"Out of Scope\"}\r\n]",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "53b151d9-95c3-4359-89aa-1a4b56478226",
                              "version": "KqlParameterItem/1.0",
                              "name": "Ownership",
                              "type": 1,
                              "description": "define who owns control",
                              "value": "",
                              "label": "Ownership/Approval"
                            },
                            {
                              "id": "578b8620-30b9-4b92-abc6-997998bc8156",
                              "version": "KqlParameterItem/1.0",
                              "name": "ImplementationDate",
                              "label": "Implementation Date",
                              "type": 4,
                              "typeSettings": {
                                "selectableValues": [],
                                "allowCustom": true
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            },
                            {
                              "id": "0d88192c-6c06-4abb-95be-4120b962c4f2",
                              "version": "KqlParameterItem/1.0",
                              "name": "EvidenceLocation",
                              "label": "Location for Evidence",
                              "type": 1,
                              "description": "Links to where control evidence or reports located",
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              }
                            },
                            {
                              "id": "7bd0d384-d3c3-4c77-9dae-d75e823edfcf",
                              "version": "KqlParameterItem/1.0",
                              "name": "Notes",
                              "type": 1,
                              "typeSettings": {
                                "multiLineText": true,
                                "editorLanguage": "text",
                                "multiLineHeight": 3
                              },
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "75",
                        "name": "Status"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "bd9c3eae-84af-42b5-8c93-e281788948d7",
                              "version": "KqlParameterItem/1.0",
                              "name": "selectState",
                              "label": "Select Compliance Status",
                              "type": 2,
                              "typeSettings": {
                                "additionalResourceOptions": [],
                                "showDefault": false
                              },
                              "jsonData": "[\"Passed\",\"Failed\",\"Skipped\"]",
                              "timeContext": {
                                "durationMs": 604800000
                              },
                              "timeContextFromParameter": "TimeRange",
                              "value": "Skipped"
                            }
                          ],
                          "style": "formHorizontal",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "customWidth": "50",
                        "name": "parameters - 13"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityResources\r\n| where type == 'microsoft.security/regulatorycompliancestandards/regulatorycompliancecontrols/regulatorycomplianceassessments'\r\n| extend ControlDescription=properties.description,\r\n  ComplianceStandard=extract(@'/regulatoryComplianceStandards/(.+)/regulatoryComplianceControls',1,id),\r\n  ComplianceControl=extract(@'/regulatoryComplianceControls/(.+)/regulatoryComplianceAssessments',1,id),\r\n  ControlDetailsLink=properties.assessmentDetailsLink,\r\n  Status=properties.state\r\n| project ComplianceStandard, ComplianceControl, ControlDescription, ControlDetailsLink, Status\r\n| where ComplianceStandard == 'NIST-SP-800-171-R2' and ComplianceControl == '3.3.9' and Status == '{selectState}'",
                          "size": 1,
                          "showAnalytics": true,
                          "showExportToExcel": true,
                          "queryType": 1,
                          "resourceType": "microsoft.resourcegraph/resources",
                          "crossComponentResources": [
                            "{Workspace}"
                          ],
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "ControlDetailsLink",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "Url"
                                }
                              }
                            ],
                            "filter": true
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "locInfoColumn": "Location",
                            "latitude": "latitude_",
                            "longitude": "longitude_",
                            "sizeSettings": "city_",
                            "sizeAggregation": "Count",
                            "labelSettings": "city_",
                            "legendMetric": "city_",
                            "numberOfMetrics": 100,
                            "legendAggregation": "Count",
                            "itemColorSettings": {
                              "nodeColorField": "state_",
                              "colorAggregation": "Count",
                              "type": "heatmap",
                              "heatmapPalette": "coldHot"
                            }
                          }
                        },
                        "name": "query - 9"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "isAUL2339Visible",
                    "comparison": "isEqualTo",
                    "value": "true"
                  },
                  "name": "AU.L2-3.3.9",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "group - 1"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isAUVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Audit and Accountability Group",
      "styleSettings": {
        "showBorder": true
      }
    }
  ],
  "fallbackResourceIds": [
    "/subscriptions/1c2186e8-24b7-4886-af84-e3b7ab6116d1/resourcegroups/cmmc-rg1/providers/microsoft.operationalinsights/workspaces/cmmcws"
  ],
  "fromTemplateId": "sentinel-CybersecurityMaturityModelCertification(CMMC)2.0",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}